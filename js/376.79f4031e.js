"use strict";(self.webpackJsonp=self.webpackJsonp||[]).push([[376],{"7477":function(t,a,r){r.d(a,{"Z":function(){return c}});r(7294);var o=r(3970),l=r(3499),i=r(5893),c=function PlanetView(t){var a=t.progress,r=t.size,c=void 0===r?"medium":r,u=t.showLabel,d=void 0===u||u,m=t.animated,h=void 0===m||m,p=t.onClick,v=(0,l.NU)(a),g="planet--".concat(c),y="planet--".concat(v),x=h?"planet--animated":"";return(0,i.jsxs)(o.G7,{"className":"planet-container ".concat(g),"onClick":p,"style":{"cursor":p?"pointer":"default"},"children":[(0,i.jsxs)(o.G7,{"className":"planet ".concat(y," ").concat(x),"children":[(0,i.jsxs)(o.G7,{"className":"planet__surface","children":["desolate"===v&&(0,i.jsx)(o.G7,{"className":"planet__cracks"}),("sprout"===v||"construction"===v)&&(0,i.jsx)(o.G7,{"className":"planet__vegetation"}),("prosperity"===v||"launch"===v||"landing"===v)&&(0,i.jsx)(o.G7,{"className":"planet__cities"}),("launch"===v||"landing"===v)&&(0,i.jsx)(o.G7,{"className":"planet__ring"})]}),(0,i.jsx)(o.G7,{"className":"planet__glow"}),h&&(0,i.jsxs)(i.Fragment,{"children":[(0,i.jsx)(o.G7,{"className":"planet__pulse"}),(0,i.jsxs)(o.G7,{"className":"planet__ai-bots","children":[(0,i.jsx)(o.G7,{"className":"ai-bot ai-bot--1"}),(0,i.jsx)(o.G7,{"className":"ai-bot ai-bot--2"}),(0,i.jsx)(o.G7,{"className":"ai-bot ai-bot--3"})]})]})]}),d&&(0,i.jsxs)(o.G7,{"className":"planet-label","children":[(0,i.jsx)(o.xv,{"className":"planet-label__name","children":"È≤®‰πãÊòü"}),(0,i.jsxs)(o.xv,{"className":"planet-label__stage","children":["¬∑ Â∑≤ËãèÈÜí ",a.toFixed(1),"%"]})]})]})}},"4162":function(t,a,r){r.d(a,{"d":function(){return S}});var o=r(5671),l=r(3144),i=r(4942),c=r(5961),u=new(function(){return(0,l.Z)(function ChestRatingEngine(){(0,o.Z)(this,ChestRatingEngine)},[{"key":"rate","value":function rate(t,a){return t.efficiencyScore>=a.diamond.minEfficiencyScore&&t.toolsUsed<=a.diamond.maxToolsUsed?"diamond":t.efficiencyScore>=a.gold.minEfficiencyScore&&t.toolsUsed<=a.gold.maxToolsUsed?"gold":t.efficiencyScore>=a.silver.minEfficiencyScore&&t.toolsUsed<=a.silver.maxToolsUsed?"silver":"bronze"}}])}()),d=r(9366),m=new(function(){return(0,l.Z)(function GameScheduler(){(0,o.Z)(this,GameScheduler)},[{"key":"getTodayGameType","value":function getTodayGameType(t,a){return Math.floor(new Date("".concat(a,"T00:00:00")).getTime()/864e5)%2==0?"3tiles":"sudoku"}},{"key":"getStorageKey","value":function getStorageKey(){return"amio_game_scheduler_v1"}}])}()),h=r(7853),p="amio_game_session_logs_v1",v=function loadLogs(){try{var t=(0,h.qu)(p);return t?JSON.parse(t):[]}catch(t){return console.error("Failed to load game logs:",t),[]}},g=function append(t){var a=v();a.push(t),function saveLogs(t){try{(0,h.Fj)(p,JSON.stringify(t))}catch(t){console.error("Failed to save game logs:",t)}}(a)},y="amio_preference_records_v1",x=function loadRecords(){try{var t=(0,h.qu)(y);return t?JSON.parse(t):[]}catch(t){return console.error("Failed to load preference records:",t),[]}},b=function save(t){var a=x().filter(function(a){return!(a.userId===t.userId&&a.date===t.date&&a.gameType===t.gameType)});a.push(t),function saveRecords(t){try{(0,h.Fj)(y,JSON.stringify(t))}catch(t){console.error("Failed to save preference records:",t)}}(a)},S=function(){return(0,l.Z)(function GameEngine(){(0,o.Z)(this,GameEngine),(0,i.Z)(this,"activePlugin",null),(0,i.Z)(this,"activeState",null),(0,i.Z)(this,"mode","normal"),(0,i.Z)(this,"userId","local-user"),(0,i.Z)(this,"date","")},[{"key":"getTodayGame","value":function getTodayGame(t,a){var r=m.getTodayGameType(t,a);return d.O.get(r)}},{"key":"setGame","value":function setGame(t){this.activePlugin=d.O.get(t)}},{"key":"startGame","value":function startGame(t){if(!this.activePlugin){var a=this.getTodayGame(t.userId||"local-user",t.date);this.activePlugin=a}return this.mode=t.mode,this.userId=t.userId||"local-user",this.date=t.date,this.activeState=this.activePlugin.initGame(t),this.activeState}},{"key":"dispatch","value":function dispatch(t){if(!this.activePlugin||!this.activeState)throw new Error("Game is not started");return this.activeState=this.activePlugin.handleAction(this.activeState,t),this.activeState}},{"key":"useTool","value":function useTool(t){if(!this.activePlugin||!this.activeState)throw new Error("Game is not started");return this.activeState=this.activePlugin.useTool(this.activeState,t),this.activeState}},{"key":"getStatus","value":function getStatus(){return this.activePlugin&&this.activeState?this.activePlugin.getStatus(this.activeState):"idle"}},{"key":"getState","value":function getState(){return this.activeState}},{"key":"enterSettlement","value":function enterSettlement(t){if(!this.activePlugin||!this.activeState)throw new Error("Game is not started");var a=this.activePlugin.getPerformance(this.activeState);return{"result":t,"chestLevel":u.rate(a,this.activePlugin.ratingConfig),"performance":a}}},{"key":"onGameEnd","value":function onGameEnd(t){var a=this.enterSettlement(t);return g({"userId":this.userId,"date":this.date,"gameType":t.gameId,"mode":this.mode,"result":t.status,"attempts":t.attempts,"durationSeconds":t.durationSeconds,"toolsUsed":t.toolsUsed,"chestLevel":a.chestLevel,"heroAttempted":t.heroAttempted,"heroResult":t.heroResult,"feedback":t.feedback}),t.feedback&&b({"userId":this.userId,"date":this.date,"gameType":t.gameId,"feedback":t.feedback}),a}},{"key":"getChestLevelAsEnum","value":function getChestLevelAsEnum(t){return function mapChestLevel(t){switch(t){case"diamond":return c.q2.DIAMOND;case"gold":return c.q2.GOLD;case"silver":return c.q2.SILVER;default:return c.q2.BRONZE}}(t)}}])}();new S},"9366":function(t,a,r){r.d(a,{"O":function(){return c}});var o=r(5671),l=r(3144),i=r(4942),c=new(function(){return(0,l.Z)(function GameRegistry(){(0,o.Z)(this,GameRegistry),(0,i.Z)(this,"plugins",new Map)},[{"key":"register","value":function register(t){this.plugins.set(t.id,t)}},{"key":"get","value":function get(t){var a=this.plugins.get(t);if(!a)throw new Error("Game plugin not found: ".concat(t));return a}},{"key":"list","value":function list(){return Array.from(this.plugins.values())}}])}())},"1024":function(t,a,r){r.d(a,{"Z":function(){return g}});r(7294);var o=r(3970),l=r(6107),i=r(5893),c=function Tile(t){var a=t.data,r=t.onClick,c=t.width,u=void 0===c?60:c,d=t.height,m=void 0===d?66:d,h=a.type,p=a.isClickable,v=(0,l.a2)(h);return(0,i.jsx)(o.G7,{"className":"tile ".concat(p?"":"disabled"),"style":{"width":"".concat(u,"px"),"height":"".concat(m,"px")},"onClick":function handleClick(){p&&r(a)},"children":v?(0,i.jsx)(o.G7,{"className":"icon-container","dangerouslySetInnerHTML":{"__html":v}}):(0,i.jsx)(o.xv,{"className":"content","children":h})})},u=function Board(t){var a=t.tiles,r=t.onTileClick;return(0,i.jsx)(o.G7,{"className":"board","children":(0,i.jsx)(o.G7,{"className":"board-container","children":(0,i.jsx)(o.G7,{"className":"tiles-area","children":a.map(function(t){return(0,i.jsx)(o.G7,{"className":"tile-wrapper","style":{"left":"".concat(36*t.x,"px"),"top":"".concat(32*t.y,"px"),"zIndex":t.layer},"children":(0,i.jsx)(c,{"data":t,"onClick":r,"width":40,"height":44})},t.id)})})})})},d=r(1413),m=r(5961),h=function Slot(t){var a=t.tiles,r=Array(m.j$).fill(null).map(function(t,r){return a[r]||null});return(0,i.jsx)(o.G7,{"className":"slot-bar","children":r.map(function(t,a){return(0,i.jsx)(o.G7,{"className":"slot-cell","children":t&&(0,i.jsx)(c,{"data":(0,d.Z)((0,d.Z)({},t),{},{"isClickable":!1}),"onClick":function onClick(){},"width":32,"height":36})},"slot-".concat(a))})})},p=function TempSlot(t){var a=t.stacks,r=t.onStackClick;return a.some(function(t){return t.length>0})?(0,i.jsx)(o.G7,{"className":"temp-slot","children":a.map(function(t,a){return(0,i.jsxs)(o.G7,{"className":"temp-position","onClick":function onClick(){return t.length>0&&r(a)},"children":[t.map(function(a,r){return(0,i.jsx)(o.G7,{"className":"stacked-tile","style":{"zIndex":r,"transform":"translate(-50%, calc(-50% - ".concat(4*r,"px))")},"children":(0,i.jsx)(c,{"data":(0,d.Z)((0,d.Z)({},a),{},{"isClickable":r===t.length-1}),"onClick":function onClick(){},"width":32,"height":36})},a.id)}),0===t.length&&(0,i.jsx)(o.G7,{"className":"empty-slot"})]},a)})}):null},v=function ToolBar(t){var a=t.onUndo,r=t.onShuffle,c=t.onRemove,u=t.undoDisabled,d=void 0!==u&&u,m=t.shuffleDisabled,h=void 0!==m&&m,p=t.removeDisabled,v=void 0!==p&&p,g=(0,l.Hi)();return(0,i.jsxs)(o.G7,{"className":"tool-bar","children":[(0,i.jsxs)(o.G7,{"className":"tool-btn ".concat(d?"disabled":""),"onClick":d?void 0:a,"children":[(0,i.jsx)(o.G7,{"className":"tool-icon","dangerouslySetInnerHTML":{"__html":g.undo}}),(0,i.jsx)(o.xv,{"className":"tool-name","children":"Êí§Âõû"}),(0,i.jsx)(o.xv,{"className":"tool-count","children":d?"0/1":"1/1"})]}),(0,i.jsxs)(o.G7,{"className":"tool-btn ".concat(v?"disabled":""),"onClick":v?void 0:c,"children":[(0,i.jsx)(o.G7,{"className":"tool-icon","dangerouslySetInnerHTML":{"__html":g.pop}}),(0,i.jsx)(o.xv,{"className":"tool-name","children":"ÁßªÂá∫"}),(0,i.jsx)(o.xv,{"className":"tool-count","children":v?"0/1":"1/1"})]}),(0,i.jsxs)(o.G7,{"className":"tool-btn ".concat(h?"disabled":""),"onClick":h?void 0:r,"children":[(0,i.jsx)(o.G7,{"className":"tool-icon","dangerouslySetInnerHTML":{"__html":g.shuffle}}),(0,i.jsx)(o.xv,{"className":"tool-name","children":"Ê¥óÁâå"}),(0,i.jsx)(o.xv,{"className":"tool-count","children":h?"0/1":"1/1"})]})]})},g=function ThreeTilesGameComponent(t){var a=t.state,r=t.onAction,o=t.onUseTool;return(0,i.jsxs)(i.Fragment,{"children":[(0,i.jsx)(u,{"tiles":a.boardTiles,"onTileClick":function onTileClick(t){return r({"type":"tile_click","payload":{"tileId":t.id}})}}),(0,i.jsx)(p,{"stacks":a.tempStacks,"onStackClick":function onStackClick(t){return r({"type":"return_temp","payload":{"positionIndex":t}})}}),(0,i.jsx)(h,{"tiles":a.slotTiles}),(0,i.jsx)(v,{"onUndo":function onUndo(){return o("undo")},"onShuffle":function onShuffle(){return o("shuffle")},"onRemove":function onRemove(){return o("pop")},"undoDisabled":a.undoUsed,"shuffleDisabled":a.shuffleUsed,"removeDisabled":a.popUsed})]})}},"4568":function(t,a,r){r.d(a,{"b":function(){return Q}});var o=r(9366),l=r(2982),i=r(1413),c=r(5961),u=function isTileBlocked(t,a){return a.some(function(a){if(a.id===t.id)return!1;if(a.layer<=t.layer)return!1;var r=Math.abs(a.x-t.x)<2,o=Math.abs(a.y-t.y)<2;return r&&o})},d=function updateClickableStatus(t){return t.map(function(a){return(0,i.Z)((0,i.Z)({},a),{},{"isClickable":!u(a,t)})})},m=function checkMatch(t){var a={};t.forEach(function(t){a[t.type]=(a[t.type]||0)+1});var r=Object.keys(a).find(function(t){return a[t]>=3});if(r){var o=0;return{"newSlots":t.filter(function(t){return!(t.type===r&&o<3)||(o++,!1)}),"matched":!0}}return{"newSlots":t,"matched":!1}},h=function getDailyLayoutSeed(){var t=new Date;return function hashString(t){for(var a=0,r=0;r<t.length;r++)a=(a<<5)-a+t.charCodeAt(r),a&=a;return Math.abs(a)}("".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"),"-").concat(String(t.getDate()).padStart(2,"0")))},p=function generateDailyLayout(t){for(var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:75,r=function createSeededRandom(t){var a=t;return function(){return(a=1103515245*a+12345&2147483647)/2147483647}}(t),o=[],l=0;l<a;l++)o.push({"x":Math.floor(9*r()),"y":Math.floor(12*r()),"layer":Math.floor(6*r())});return o.sort(function(t,a){return t.layer-a.layer}),o},v=function assignRandomTileTypes(t){for(var a=Object.values(c.YU),r=Math.floor(t.length/3),o=[],l=0;l<r;l++){var i=a[Math.floor(Math.random()*a.length)];o.push(i,i,i)}for(var u=o.length-1;u>0;u--){var m=Math.floor(Math.random()*(u+1)),h=[o[m],o[u]];o[u]=h[0],o[m]=h[1]}var p=t.map(function(t,a){return{"id":"tile-".concat(a),"type":o[a]||c.YU.STAR,"x":t.x,"y":t.y,"layer":t.layer,"isClickable":!0}});return d(p)},g=function generateHeroLevel(t){var a=function generateHeroLayout(t){for(var a=function createSeededRandom(t){var a=t;return function(){return(a=1103515245*a+12345&2147483647)/2147483647}}(t+1e3),r=[],o=0;o<150;o++)r.push({"x":Math.floor(9*a()),"y":Math.floor(12*a()),"layer":Math.floor(8*a())});return r.sort(function(t,a){return t.layer-a.layer}),r}(t);return function assignHeroTileTypes(t){for(var a=Object.values(c.YU),r=[].concat(a),o=Math.floor(t.length/3),l=[],i=0;i<o;i++){var u=r[Math.floor(Math.random()*r.length)];l.push(u,u,u)}for(var m=l.length-1;m>0;m--){var h=Math.floor(Math.random()*(m+1)),p=[l[h],l[m]];l[m]=p[0],l[h]=p[1]}var v=t.map(function(t,a){return{"id":"hero-tile-".concat(a),"type":l[a]||c.YU.STAR,"x":t.x,"y":t.y,"layer":t.layer,"isClickable":!0}});return d(v)}(a)},y=function shuffleBoard(t){for(var a=t.map(function(t){return{"x":t.x,"y":t.y,"layer":t.layer}}),r=(0,l.Z)(a),o=r.length-1;o>0;o--){var c=Math.floor(Math.random()*(o+1)),u=[r[c],r[o]];r[o]=u[0],r[c]=u[1]}var m=t.map(function(t,a){return(0,i.Z)((0,i.Z)({},t),{},{"x":r[a].x,"y":r[a].y,"layer":r[a].layer})});return d(m)},x=r(6891),b=function applyWinOrLossState(t){return function isCleared(t){var a=t.tempStacks.reduce(function(t,a){return t+a.length},0);return 0===t.boardTiles.length&&0===t.slotTiles.length&&0===a}(t)?(0,i.Z)((0,i.Z)({},t),{},{"status":"cleared","endedAt":Date.now()}):t.slotTiles.length>=7?(0,i.Z)((0,i.Z)({},t),{},{"status":"failed","endedAt":Date.now()}):t},S=function handleReturnFromTemp(t,a){var r=function returnTileFromTempStack(t,a,r,o){if(a.length>=o)return{"newSlot":a,"newTempStacks":r,"success":!1};if(t<0||t>=r.length)return{"newSlot":a,"newTempStacks":r,"success":!1};if(0===r[t].length)return{"newSlot":a,"newTempStacks":r,"success":!1};var i=r.map(function(t){return(0,l.Z)(t)}),c=i[t].pop();return{"newSlot":[].concat((0,l.Z)(a),[c]),"newTempStacks":i,"success":!0}}(a,t.slotTiles,t.tempStacks,7),o=r.newSlot,c=r.newTempStacks;if(!r.success)return t;var u=m(o).newSlots;return b((0,i.Z)((0,i.Z)({},t),{},{"slotTiles":u,"tempStacks":c}))},k=function addToolUsage(t){return(0,i.Z)((0,i.Z)({},t),{},{"toolsUsed":t.toolsUsed+1})},j=function mapChestToScore(t){switch(t){case c.q2.DIAMOND:return 100;case c.q2.GOLD:return 80;case c.q2.SILVER:return 60;default:return 30}},_={"enabled":!0,"mode":"hero","description":"Êõ¥È´òÂØÜÂ∫¶Â†ÜÂè†ÁöÑÈ´òÈöæÊ®°ÂºèÔºå‰ªÖÊúâ‰∏ÄÊ¨°Êú∫‰ºöÂÜ≤ÂáªÂÆùÁÆ±ÂçáÁ∫ß„ÄÇ"},T=(r(7294),r(3970)),N=r(5893),C={"id":"3tiles","meta":{"id":"3tiles","narrativeName":"ÊòüÊΩÆÂêåË∞É","narrativeDesc":"","icon":"üÄÑÔ∏è","thumbnailComponent":function ThreeTilesThumbnail(){return(0,N.jsxs)(T.G7,{"className":"three-tiles-thumbnail","aria-hidden":"true","children":[(0,N.jsx)(T.xv,{"className":"three-tiles-thumbnail__title","children":"ÊòüÊΩÆÂêåË∞É"}),(0,N.jsx)(T.xv,{"className":"three-tiles-thumbnail__subtitle","children":"ËΩªÂø´Ê∂àÈô§"})]})},"energyReward":120},"ratingConfig":{"diamond":{"minEfficiencyScore":95,"maxToolsUsed":0},"gold":{"minEfficiencyScore":75,"maxToolsUsed":1},"silver":{"minEfficiencyScore":50,"maxToolsUsed":3}},"initGame":function initThreeTilesState(t){var a,r=Date.now(),o=null!==(a=t.seed)&&void 0!==a?a:h();if("hero"===t.mode)return{"gameId":"3tiles","mode":"hero","status":"playing","startedAt":r,"attempts":1,"toolsUsed":0,"boardTiles":g(o),"slotTiles":[],"tempStacks":[[],[],[]],"undoUsed":!1,"shuffleUsed":!1,"popUsed":!1,"dailySeed":o,"dailyLayout":[]};var l=function createNormalTiles(t){var a=p(t,75);return{"layout":a,"tiles":v(a)}}(o),i=l.layout;return{"gameId":"3tiles","mode":"normal","status":"playing","startedAt":r,"attempts":1,"toolsUsed":0,"boardTiles":l.tiles,"slotTiles":[],"tempStacks":[[],[],[]],"undoUsed":!1,"shuffleUsed":!1,"popUsed":!1,"dailySeed":o,"dailyLayout":i}},"handleAction":function handleThreeTilesAction(t,a){switch(a.type){case"tile_click":var r,o=null===(r=a.payload)||void 0===r?void 0:r.tileId;return"string"!=typeof o?t:function handleTileClick(t,a){if("playing"!==t.status)return t;var r=function findTileById(t,a){return t.find(function(t){return t.id===a})}(t.boardTiles,a);if(!r||!r.isClickable)return t;var o=d(t.boardTiles.filter(function(t){return t.id!==a})),c=m([].concat((0,l.Z)(t.slotTiles),[r])),u=c.newSlots,h=(c.matched,(0,i.Z)((0,i.Z)({},t),{},{"boardTiles":o,"slotTiles":u}));return b(h)}(t,o);case"retry":return function handleRetry(t){if("hero"===t.mode)return(0,i.Z)((0,i.Z)({},t),{},{"status":"playing","attempts":t.attempts+1,"toolsUsed":0,"undoUsed":!1,"shuffleUsed":!1,"popUsed":!1,"endedAt":void 0,"boardTiles":g(t.dailySeed),"slotTiles":[],"tempStacks":[[],[],[]]});var a=v(t.dailyLayout);return(0,i.Z)((0,i.Z)({},t),{},{"status":"playing","attempts":t.attempts+1,"toolsUsed":0,"undoUsed":!1,"shuffleUsed":!1,"popUsed":!1,"endedAt":void 0,"boardTiles":a,"slotTiles":[],"tempStacks":[[],[],[]]})}(t);case"return_temp":var c,u=null===(c=a.payload)||void 0===c?void 0:c.positionIndex;return"number"!=typeof u?t:S(t,u);case"quit":return(0,i.Z)((0,i.Z)({},t),{},{"status":"quit","endedAt":Date.now()});default:return t}},"getStatus":function getThreeTilesStatus(t){return t.status},"getPerformance":function getThreeTilesPerformance(t){var a=(0,x.ns)();a.attempts=t.attempts,a.toolsUsed=t.toolsUsed;var r=(0,x.HS)(a);return{"efficiencyScore":j(r),"toolsUsed":t.toolsUsed,"rawData":{"attempts":t.attempts,"mode":t.mode,"status":t.status,"chestLevel":r}}},"getTools":function getTools(){return[{"id":"undo","name":"ÂõûÈÄÄ","description":"Â∞ÜÊßΩ‰ΩçÊúÄÂêé‰∏Ä‰∏™ÂõæÂùóÈÄÄÂõûÊ£ãÁõò„ÄÇ","freeUses":1},{"id":"pop","name":"ÊäΩÁ¶ª","description":"ÊääÊßΩ‰ΩçÂâçÈù¢ÁöÑÂõæÂùó‰∏¥Êó∂ÁßªÂá∫„ÄÇ","freeUses":1},{"id":"shuffle","name":"Ê¥óÁâå","description":"ÈáçÊñ∞Êâì‰π±Ê£ãÁõòÂõæÂùó‰ΩçÁΩÆ„ÄÇ","freeUses":1}]},"useTool":function useThreeTilesTool(t,a){if("playing"!==t.status)return t;if("undo"===a){if(t.undoUsed)return t;var r=function undoLastTile(t,a){if(0===a.length)return{"newBoard":t,"newSlot":a,"success":!1};var r=a[a.length-1],o=a.slice(0,-1),i=[].concat((0,l.Z)(t),[r]);return{"newBoard":d(i),"newSlot":o,"success":!0}}(t.boardTiles,t.slotTiles),o=r.newBoard,c=r.newSlot;return r.success?k((0,i.Z)((0,i.Z)({},t),{},{"boardTiles":o,"slotTiles":c,"undoUsed":!0})):t}if("shuffle"===a)return t.shuffleUsed?t:k((0,i.Z)((0,i.Z)({},t),{},{"boardTiles":y(t.boardTiles),"shuffleUsed":!0}));if("pop"===a){if(t.popUsed)return t;var u=function popTilesToTemp(t,a){if(0===t.length)return{"remainSlot":t,"newTempStacks":a,"success":!1};var r=Math.min(t.length,3),o=t.slice(0,r),i=t.slice(r),c=3===a.length?a.map(function(t){return(0,l.Z)(t)}):[[],[],[]];return o.forEach(function(t,a){c[a].push(t)}),{"remainSlot":i,"newTempStacks":c,"success":!0}}(t.slotTiles,t.tempStacks),m=u.remainSlot,h=u.newTempStacks;return u.success?k((0,i.Z)((0,i.Z)({},t),{},{"slotTiles":m,"tempStacks":h,"popUsed":!0})):t}return t},"getHeroConfig":function getHeroConfig(){return _},"GameComponent":function getThreeTilesGameComponent(){return r(1024).Z}()},Z=r(885),G=r(181);function createForOfIteratorHelper_createForOfIteratorHelper(t,a){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=(0,G.Z)(t))||a&&t&&"number"==typeof t.length){r&&(t=r);var o=0,l=function F(){};return{"s":l,"n":function n(){return o>=t.length?{"done":!0}:{"done":!1,"value":t[o++]}},"e":function e(t){throw t},"f":l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,u=!1;return{"s":function s(){r=r.call(t)},"n":function n(){var t=r.next();return c=t.done,t},"e":function e(t){u=!0,i=t},"f":function f(){try{c||null==r.return||r.return()}finally{if(u)throw i}}}}var w=function cloneGrid(t){return t.map(function(t){return(0,l.Z)(t)})},U=function findEmpty(t){for(var a=0;a<t.length;a+=1)for(var r=0;r<t[a].length;r+=1)if(null===t[a][r])return[a,r];return null},M=function isValidPlacement(t,a,r,o,l){for(var i=0;i<l.size;i+=1){if(t[a][i]===o&&i!==r)return!1;if(t[i][r]===o&&i!==a)return!1}for(var c=Math.floor(a/l.boxRows)*l.boxRows,u=Math.floor(r/l.boxCols)*l.boxCols,d=c;d<c+l.boxRows;d+=1)for(var m=u;m<u+l.boxCols;m+=1)if((d!==a||m!==r)&&t[d][m]===o)return!1;return!0},I=function countBacktracking(t,a,r){var o=U(t);if(!o)return 1;var l,i=(0,Z.Z)(o,2),c=i[0],u=i[1],d=0,m=createForOfIteratorHelper_createForOfIteratorHelper(a.symbols);try{for(m.s();!(l=m.n()).done;){var h=l.value;if(M(t,c,u,h,a)){if(t[c][u]=h,(d+=I(t,a,r))>=r)return t[c][u]=null,d;t[c][u]=null}}}catch(t){m.e(t)}finally{m.f()}return d},L=function countSudokuSolutions(t,a){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,o=w(t);return I(o,a,r)},D=function shuffle(t,a){for(var r=(0,l.Z)(t),o=r.length-1;o>0;o-=1){var i=Math.floor(a()*(o+1)),c=[r[i],r[o]];r[o]=c[0],r[i]=c[1]}return r},R=function clone(t){return t.map(function(t){return(0,l.Z)(t)})},A=function generateSudokuPuzzle(t){var a,r=function getSudokuRules(t){return"hero"===t?{"size":6,"boxRows":2,"boxCols":3,"symbols":["üèì","‚≠ê","ü¶à","üíô","üèÖ","üëë"]}:{"size":4,"boxRows":2,"boxCols":2,"symbols":["üèì","‚≠ê","ü¶à","üíô"]}}(t.mode),o=function createSeededRandom(t){var a=t;return function(){return(a=1664525*a+1013904223>>>0)/4294967295}}(null!==(a=t.seed)&&void 0!==a?a:Date.now()),i=function createSolvedGrid(t,a){var r=(0,l.Z)(Array(t.size).keys()),o=(0,l.Z)(Array(t.size).keys()),i=(0,l.Z)(Array(t.size/t.boxRows).keys()),c=(0,l.Z)(Array(t.size/t.boxCols).keys()),u=D(i,a).flatMap(function(o){return D(r.slice(o*t.boxRows,(o+1)*t.boxRows),a)}),d=D(c,a).flatMap(function(r){return D(o.slice(r*t.boxCols,(r+1)*t.boxCols),a)}),m=D(t.symbols,a);return u.map(function(a){return d.map(function(r){var o=(a*t.boxCols+Math.floor(a/t.boxRows)+r)%t.size;return m[o]})})}(r,o),c="hero"===t.mode?12:6,u="hero"===t.mode?16:8,d=function removeCellsWithUniqueSolution(t,a,r,o){for(var i=t.map(function(t){return(0,l.Z)(t)}),c=[],u=0;u<a.size;u+=1)for(var d=0;d<a.size;d+=1)c.push([u,d]);var m,h=D(c,o),p=a.size*a.size,v=createForOfIteratorHelper_createForOfIteratorHelper(h);try{for(v.s();!(m=v.n()).done;){var g=(0,Z.Z)(m.value,2),y=g[0],x=g[1];if(p<=r)break;var b=i[y][x];i[y][x]=null,1===L(R(i),a,2)?p-=1:i[y][x]=b}}catch(t){v.e(t)}finally{v.f()}return i}(i,r,c+Math.floor(o()*(u-c+1)),o);return{"size":r.size,"boxRows":r.boxRows,"boxCols":r.boxCols,"symbols":r.symbols,"givens":d,"solution":i}},z=function SudokuBoard(t){var a=t.size,r=t.boxRows,o=t.boxCols,l=t.grid,i=t.givens,c=t.selectedCell,u=t.errorCells,d=t.onSelect;return(0,N.jsx)(T.G7,{"className":"sudoku-board","data-board-size":String(a),"children":l.map(function(t,l){return(0,N.jsx)(T.G7,{"className":"sudoku-row","children":t.map(function(t,m){var h=null!==i[l][m],p=(null==c?void 0:c.row)===l&&(null==c?void 0:c.col)===m,v=u.some(function(t){return t.row===l&&t.col===m}),g=["sudoku-cell",h?"sudoku-cell--given":"",p?"sudoku-cell--selected":"",v?"sudoku-cell--error":"",l%r===0?"sudoku-cell--box-top":"",m%o===0?"sudoku-cell--box-left":"",l===a-1?"sudoku-cell--box-bottom":"",m===a-1?"sudoku-cell--box-right":""].filter(Boolean).join(" ");return(0,N.jsx)(T.G7,{"className":g,"data-cell-row":String(l),"data-cell-col":String(m),"data-cell-given":h?"true":"false","data-cell-selected":p?"true":"false","data-cell-error":v?"true":"false","onClick":function onClick(){return d(l,m)},"children":(0,N.jsx)(T.xv,{"children":null!=t?t:""})},"cell-".concat(l,"-").concat(m))})},"row-".concat(l))})})},E=function IconSelector(t){var a=t.symbols,r=t.onPick,o=t.onClear,l=t.disabled,i=void 0!==l&&l,c=t.disabledReason,u=void 0===c?null:c;return(0,N.jsxs)(T.G7,{"className":"icon-selector".concat(i?" icon-selector--disabled":""),"children":[a.map(function(t,a){return(0,N.jsx)(T.G7,{"className":"icon-selector__item".concat(i?" icon-selector__item--disabled":""),"data-selector-symbol":t,"onClick":function onClick(){i||r(t)},"children":(0,N.jsx)(T.xv,{"children":t})},"".concat(t,"-").concat(a))}),(0,N.jsx)(T.G7,{"className":"icon-selector__item".concat(i?" icon-selector__item--disabled":""),"data-selector-symbol":"clear","onClick":function onClick(){i||o()},"children":(0,N.jsx)(T.xv,{"children":"‚úï"})}),i&&u&&(0,N.jsx)(T.xv,{"className":"icon-selector__reason","children":u})]})},O=function HeroTimer(t){var a=t.remainingSeconds,r=t.totalSeconds,o=Math.max(0,Math.min(1,a/r)),l=a<=30;return(0,N.jsxs)(T.G7,{"className":"hero-timer".concat(l?" hero-timer--danger":""),"data-danger":l?"true":"false","children":[(0,N.jsx)(T.G7,{"className":"hero-timer__bar","style":{"width":"".concat(100*o,"%")}}),(0,N.jsxs)(T.xv,{"className":"hero-timer__text","children":[a,"s"]})]})},q=function cloneGrid(t){return t.map(function(t){return(0,l.Z)(t)})},P=function collectErrors(t,a){for(var r=[],o=0;o<t.length;o+=1)for(var l=0;l<t[o].length;l+=1)null!==t[o][l]&&t[o][l]!==a[o][l]&&r.push({"row":o,"col":l});return r},H=function isInBounds(t,a,r){return a>=0&&r>=0&&a<t.puzzle.size&&r<t.puzzle.size},B=function evaluateSudokuState(t){if("hero"===t.mode&&t.remainingSeconds<=0)return(0,i.Z)((0,i.Z)({},t),{},{"status":"failed","endedAt":Date.now(),"remainingSeconds":0});if(!function allFilled(t){return t.every(function(t){return t.every(function(t){return null!==t})})}(t.grid))return(0,i.Z)((0,i.Z)({},t),{},{"errorCells":[]});var a=P(t.grid,t.puzzle.solution);return 0===a.length?(0,i.Z)((0,i.Z)({},t),{},{"status":"cleared","endedAt":Date.now(),"errorCells":[]}):(0,i.Z)((0,i.Z)({},t),{},{"errorCells":a,"uiMessage":"Â≠òÂú®ÈîôËØØÊ†ºÂ≠êÔºåËØ∑‰øÆÊ≠£È´ò‰∫Æ‰ΩçÁΩÆ„ÄÇ"})},V=function createSudokuState(t){var a=A({"mode":t.mode,"seed":t.seed});return{"gameId":"sudoku","mode":t.mode,"status":"playing","startedAt":Date.now(),"attempts":1,"toolsUsed":0,"puzzle":a,"grid":q(a.givens),"selectedCell":null,"errorCells":[],"hintUsed":0,"checkUsed":0,"remainingSeconds":"hero"===t.mode?180:0,"maxHint":1,"maxCheck":0,"lastUnavailableAction":null,"uiMessage":null}},W=function canEditCell(t,a,r){return!!H(t,a,r)&&null===t.puzzle.givens[a][r]},J=function setCellValue(t,a){if(!t.selectedCell)return(0,i.Z)((0,i.Z)({},t),{},{"uiMessage":"ËØ∑ÂÖàÈÄâÊã©ÂèØÂ°´ÂÜôÁöÑÊ†ºÂ≠ê„ÄÇ"});var r=t.selectedCell,o=r.row,l=r.col;if(!W(t,o,l))return(0,i.Z)((0,i.Z)({},t),{},{"uiMessage":"ËØ•Ê†ºÂ≠ê‰∏∫Âõ∫ÂÆöÊï∞Â≠óÔºåÊó†Ê≥ï‰øÆÊîπ„ÄÇ"});var c=q(t.grid);return c[o][l]=a,B((0,i.Z)((0,i.Z)({},t),{},{"grid":c,"uiMessage":null}))},Y=function getDurationSeconds(t){var a,r=null!==(a=t.endedAt)&&void 0!==a?a:Date.now();return Math.max(1,Math.floor((r-t.startedAt)/1e3))},K=function getEfficiencyScore(t){var a=Y(t),r=30;a<=120?r=95:a<=240?r=75:a<=480&&(r=50);var o=8*t.toolsUsed;return Math.max(0,r-o)},X={"id":"sudoku","meta":{"id":"sudoku","narrativeName":"ÊòüÂõæËß£Á†Å","narrativeDesc":"","icon":"üîÆ","thumbnailComponent":function SudokuThumbnail(){return(0,N.jsxs)(T.G7,{"className":"sudoku-thumbnail","aria-hidden":"true","children":[(0,N.jsx)(T.xv,{"className":"sudoku-thumbnail__title","children":"ÊòüÂõæËß£Á†Å"}),(0,N.jsx)(T.xv,{"className":"sudoku-thumbnail__subtitle","children":"Ê≤âÊµ∏Ëß£Ë∞ú"})]})},"energyReward":120},"ratingConfig":{"diamond":{"minEfficiencyScore":90,"maxToolsUsed":0},"gold":{"minEfficiencyScore":70,"maxToolsUsed":1},"silver":{"minEfficiencyScore":40,"maxToolsUsed":2}},"initGame":V,"handleAction":function handleAction(t,a){if("playing"!==t.status&&"retry"!==a.type)return t;switch(a.type){case"select_cell":var r,o,l=null===(r=a.payload)||void 0===r?void 0:r.row,c=null===(o=a.payload)||void 0===o?void 0:o.col;return"number"!=typeof l||"number"!=typeof c?(0,i.Z)((0,i.Z)({},t),{},{"uiMessage":"Êó†ÊïàÁöÑÊ†ºÂ≠êÈÄâÊã©„ÄÇ"}):H(t,l,c)?W(t,l,c)?(0,i.Z)((0,i.Z)({},t),{},{"selectedCell":{"row":l,"col":c},"uiMessage":null}):(0,i.Z)((0,i.Z)({},t),{},{"selectedCell":{"row":l,"col":c},"uiMessage":"ËØ•Ê†ºÂ≠ê‰∏∫Âõ∫ÂÆöÊï∞Â≠óÔºåÊó†Ê≥ï‰øÆÊîπ„ÄÇ"}):(0,i.Z)((0,i.Z)({},t),{},{"uiMessage":"Êó†ÊïàÁöÑÊ†ºÂ≠êÈÄâÊã©„ÄÇ"});case"input_symbol":var u,d=null===(u=a.payload)||void 0===u?void 0:u.symbol;return"string"!=typeof d?(0,i.Z)((0,i.Z)({},t),{},{"uiMessage":"Êó†ÊïàÁöÑÁ¨¶Âè∑ÈÄâÊã©„ÄÇ"}):t.puzzle.symbols.includes(d)?J(t,d):(0,i.Z)((0,i.Z)({},t),{},{"uiMessage":"Êó†ÊïàÁöÑÁ¨¶Âè∑ÈÄâÊã©„ÄÇ"});case"clear_cell":return J(t,null);case"tick":var m;if("hero"!==t.mode)return t;var h=null===(m=a.payload)||void 0===m?void 0:m.deltaSeconds,p="number"==typeof h&&h>0?h:1;return B((0,i.Z)((0,i.Z)({},t),{},{"remainingSeconds":Math.max(0,t.remainingSeconds-p)}));case"retry":return(0,i.Z)((0,i.Z)({},V({"mode":t.mode,"date":"","seed":Date.now()})),{},{"attempts":t.attempts+1});case"quit":return(0,i.Z)((0,i.Z)({},t),{},{"status":"quit","endedAt":Date.now(),"uiMessage":null});default:return t}},"getStatus":function getStatus(t){return t.status},"getPerformance":function getPerformance(t){return{"efficiencyScore":K(t),"toolsUsed":t.toolsUsed,"rawData":{"attempts":t.attempts,"durationSeconds":Y(t),"mode":t.mode,"remainingSeconds":t.remainingSeconds}}},"getTools":function getTools(){return[{"id":"hint","name":"ÊèêÁ§∫","description":"Ëá™Âä®Â°´ÂÜô‰∏Ä‰∏™Ê≠£Á°ÆÊ†ºÂ≠ê„ÄÇ","freeUses":1},{"id":"check","name":"Ê†°È™å","description":"MVP Èò∂ÊÆµÊöÇÊú™ÂºÄÊîæÔºåÂêéÁª≠ÁâàÊú¨Ë°•ÂÖÖ„ÄÇ","freeUses":0}]},"useTool":function useTool(t,a){if("playing"!==t.status)return t;if("hint"===a){if(t.hintUsed>=t.maxHint)return(0,i.Z)((0,i.Z)({},t),{},{"lastUnavailableAction":"hint","uiMessage":"ÊèêÁ§∫Ê¨°Êï∞Â∑≤Áî®ÂÆå„ÄÇ"});var r=function findHintCell(t){for(var a=0;a<t.grid.length;a+=1)for(var r=0;r<t.grid[a].length;r+=1)if(W(t,a,r)&&t.grid[a][r]!==t.puzzle.solution[a][r])return{"row":a,"col":r};return null}(t);if(!r)return(0,i.Z)((0,i.Z)({},t),{},{"uiMessage":"ÂΩìÂâçÊ≤°ÊúâÂèØÊèêÁ§∫ÁöÑÊ†ºÂ≠ê„ÄÇ"});var o=q(t.grid);return o[r.row][r.col]=t.puzzle.solution[r.row][r.col],B((0,i.Z)((0,i.Z)({},t),{},{"grid":o,"hintUsed":t.hintUsed+1,"toolsUsed":t.toolsUsed+1,"lastUnavailableAction":null,"uiMessage":"Â∑≤Ëá™Âä®Â°´ÂÜô‰∏Ä‰∏™Ê†ºÂ≠ê„ÄÇ"}))}return"check"===a?t.maxCheck<=t.checkUsed?(0,i.Z)((0,i.Z)({},t),{},{"lastUnavailableAction":"check","uiMessage":"MVP Èò∂ÊÆµÊöÇ‰∏çÂºÄÊîæÊ†°È™åÂäüËÉΩ„ÄÇ"}):(0,i.Z)((0,i.Z)({},t),{},{"checkUsed":t.checkUsed+1,"toolsUsed":t.toolsUsed+1,"errorCells":P(t.grid,t.puzzle.solution),"uiMessage":null}):(0,i.Z)((0,i.Z)({},t),{},{"uiMessage":"Êú™Áü•ÁöÑÈÅìÂÖ∑Êìç‰Ωú„ÄÇ"})},"getHeroConfig":function getHeroConfig(){return{"enabled":!0,"mode":"hero","timeLimitSeconds":180,"description":"6x6 ÂõæÊ†áÊï∞Áã¨ÔºåÈôêÊó∂ 3 ÂàÜÈíü„ÄÇ"}},"GameComponent":function SudokuGameComponent(t){var a=t.state,r=t.onAction,o=t.onUseTool,l=t.mode,i=function getSelectorDisabledReason(t){if(!t.selectedCell)return"ËØ∑ÂÖàÈÄâÊã©ÂèØÂ°´ÂÜôÁöÑÊ†ºÂ≠ê„ÄÇ";var a=t.selectedCell,r=a.row,o=a.col;return W(t,r,o)?null:"ËØ•Ê†ºÂ≠ê‰∏∫Âõ∫ÂÆöÊï∞Â≠óÔºåÊó†Ê≥ï‰øÆÊîπ„ÄÇ"}(a),c=null!==i,u=Math.max(0,a.maxHint-a.hintUsed),d=Math.max(0,a.maxCheck-a.checkUsed),m=d<=0;return(0,N.jsxs)(T.G7,{"className":"sudoku-game ".concat("hero"===l?"sudoku-game--hero":""),"children":[(0,N.jsx)(T.xv,{"className":"sudoku-game__title","children":"ÊòüÂõæËß£Á†Å"}),"hero"===l&&(0,N.jsx)(O,{"remainingSeconds":a.remainingSeconds,"totalSeconds":180}),(0,N.jsx)(z,{"size":a.puzzle.size,"boxRows":a.puzzle.boxRows,"boxCols":a.puzzle.boxCols,"grid":a.grid,"givens":a.puzzle.givens,"selectedCell":a.selectedCell,"errorCells":a.errorCells,"onSelect":function onSelect(t,a){return r({"type":"select_cell","payload":{"row":t,"col":a}})}}),(0,N.jsx)(E,{"symbols":a.puzzle.symbols,"onPick":function onPick(t){return r({"type":"input_symbol","payload":{"symbol":t}})},"onClear":function onClear(){return r({"type":"clear_cell"})},"disabled":c,"disabledReason":i}),(0,N.jsxs)(T.G7,{"className":"sudoku-tools","children":[(0,N.jsx)(T.G7,{"className":"sudoku-tools__item".concat(u<=0?" sudoku-tools__item--disabled":""),"onClick":function onClick(){return o("hint")},"children":(0,N.jsxs)(T.xv,{"children":["üí° ÊèêÁ§∫ ",u,"/",a.maxHint]})}),(0,N.jsx)(T.G7,{"className":"sudoku-tools__item".concat(m?" sudoku-tools__item--disabled":""),"onClick":function onClick(){return o("check")},"children":(0,N.jsxs)(T.xv,{"children":["‚úÖ Ê†°È™å ",d,"/",a.maxCheck]})})]}),a.uiMessage&&(0,N.jsx)(T.xv,{"className":"sudoku-message","children":a.uiMessage})]})}},$=!1,Q=function registerBuiltInGames(){$||(o.O.register(C),o.O.register(X),$=!0)}},"9376":function(t,a,r){r.r(a),r.d(a,{"default":function(){return j}});var o=r(885),l=r(1413),i=r(7294),c=r(3970),u=r(4536),d=(r(7853),r(7477)),m=r(5893),h=function TodayGameCard(t){var a=t.meta,r=t.cardState,o=t.display,l=t.chestLabel,i=t.onStart,u=t.onHero,d=t.onExit,h=t.feedbackSlot,p=a.thumbnailComponent,v="is-".concat(r),g=o||{"badgeText":"‰ªäÊó•‰ªªÂä°","energyLabel":"+".concat(a.energyReward," ÊòüËÉΩ"),"chestStatLabel":l?"ÂÆùÁÆ± ".concat(l):void 0,"journeyHint":"‰ªäÂ§©Êù•‰∏ÄÂ±ÄÔºåÊòüÁêÉÂ∞±‰ºöÊõ¥‰∫Æ‰∏ÄÁÇπ„ÄÇ","startActionLabel":"ÂºÄÂßãÊåëÊàò","heroActionLabel":"ÊåëÊàòËã±ÈõÑÊ®°Âºè","doneActionLabel":"ÂéªÊòüÊµ∑ÁúãÁúã","closeActionLabel":"ÂéªÊòüÊµ∑ÁúãÁúã"};return(0,m.jsxs)(c.G7,{"className":"today-game-card ".concat(v),"children":[(0,m.jsxs)(c.G7,{"className":"today-game-card__header","children":[(0,m.jsx)(c.xv,{"className":"today-game-card__badge","children":g.badgeText}),(0,m.jsx)(c.xv,{"className":"today-game-card__energy","children":g.energyLabel})]}),(0,m.jsx)(c.G7,{"className":"today-game-card__hero","children":(0,m.jsx)(c.G7,{"className":"today-game-card__thumb","children":(0,m.jsx)(p,{})})}),g.chestStatLabel&&(0,m.jsx)(c.G7,{"className":"today-game-card__stats","children":(0,m.jsx)(c.xv,{"className":"today-game-card__stat","children":g.chestStatLabel})}),(0,m.jsx)(c.xv,{"className":"today-game-card__hint","children":g.journeyHint}),h&&(0,m.jsx)(c.G7,{"className":"today-game-card__feedback","children":h}),(0,m.jsxs)(c.G7,{"className":"today-game-card__actions","children":[("idle"===r||"playing"===r)&&(0,m.jsx)(c.G7,{"className":"today-game-card__button","onClick":i,"children":(0,m.jsx)(c.xv,{"children":g.startActionLabel})}),"completed"===r&&(0,m.jsxs)(m.Fragment,{"children":[(0,m.jsx)(c.G7,{"className":"today-game-card__button","onClick":u,"children":(0,m.jsx)(c.xv,{"children":g.heroActionLabel})}),(0,m.jsx)(c.G7,{"className":"today-game-card__button today-game-card__button--secondary","onClick":d,"children":(0,m.jsx)(c.xv,{"children":g.doneActionLabel})})]}),("hero"===r||"done"===r)&&(0,m.jsx)(c.G7,{"className":"today-game-card__button today-game-card__button--secondary","onClick":d,"children":(0,m.jsx)(c.xv,{"children":g.closeActionLabel})})]})]})},p=function StreakMilestones(t){var a=t.currentDays,r=t.milestones,o=r.find(function(t){return a<t.days})||null;return(0,m.jsxs)(c.G7,{"className":"streak-milestones","children":[(0,m.jsxs)(c.xv,{"className":"streak-milestones__title","children":["üî• Streak ",a," days"]}),(0,m.jsx)(c.pf,{"scrollX":!0,"className":"streak-milestones__scroll","children":(0,m.jsx)(c.G7,{"className":"streak-milestones__items","children":r.map(function(t){var r=a>=t.days,l=(null==o?void 0:o.days)===t.days,i=Math.max(0,t.days-a);return(0,m.jsxs)(c.G7,{"className":"streak-milestones__item","children":[(0,m.jsx)(c.xv,{"className":"streak-milestones__dot".concat(r?" is-completed":"").concat(l?" is-next":""),"children":r?"‚úÖ":"‚óã"}),(0,m.jsx)(c.xv,{"className":"streak-milestones__label","children":t.label}),l&&(0,m.jsxs)(c.xv,{"className":"streak-milestones__hint","children":[i," days left"]})]},t.days)})})})]})},v=r(4162),g=r(7118),y=r(4568),x=r(5589),b=r(6891),S=r(3499),k="local-user",j=function Starlight(){var t=(0,i.useState)(null),a=(0,o.Z)(t,2),r=a[0],j=a[1],_=(0,i.useState)(67.3),T=(0,o.Z)(_,2),N=T[0],C=T[1],Z=(0,i.useState)((0,x.zo)()),G=(0,o.Z)(Z,2),w=G[0],U=G[1],M=(0,i.useState)(""),I=(0,o.Z)(M,2),L=I[0],D=I[1],R=(0,i.useState)(null),A=(0,o.Z)(R,2),z=A[0],E=A[1],O=(0,i.useState)("idle"),q=(0,o.Z)(O,2),P=q[0],H=q[1],B=(0,i.useState)((0,x._G)()),V=(0,o.Z)(B,2),W=V[0],J=V[1],Y=(0,i.useRef)(""),K=(0,i.useMemo)(function(){return(0,y.b)(),new v.d},[]),X=(0,i.useMemo)(function(){return K.getTodayGame(k,W)},[K,W]),$=function refreshProgress(){var t=(0,x._G)();J(t);var a=(0,x.yu)();j(a),U((0,x.zo)()),H(function deriveCardState(t){return t.todayCompleted?t.heroAttempted?t.heroAttempted&&!t.heroCompleted?"hero":"done":"completed":"idle"}(a)),(0,S.cL)().then(function(t){C(t.progress)}).catch(function(t){console.error("Failed to sync planet progress:",t)})};(0,i.useEffect)(function(){$()},[]),u.ZP.useDidShow(function(){$()}),(0,i.useEffect)(function(){var t=function updateCountdown(){var t=(0,x.zo)();U(t),t.remainingTime>0&&D((0,x.dH)(t.remainingTime))};t();var a=setInterval(t,1e3);return function(){return clearInterval(a)}},[]),(0,i.useEffect)(function(){var t="completed"===P?"hero":"idle"===P||"playing"===P?"start":null;if(t){var a="".concat(W,":").concat(X.id,":").concat(P,":").concat(t);Y.current!==a&&(Y.current=a,g.W.append({"userId":k,"date":W,"event":"starlight_cta_exposed","metadata":{"cardState":P,"ctaType":t,"gameType":X.id}}),"completed"===P&&g.W.append({"userId":k,"date":W,"event":"hero_prompt_shown","metadata":{"gameType":X.id}}))}},[P,W,X.id]);var Q=function handleChestClick(){if(null!=r&&r.pendingChest){var t=(0,x.zo)();if("locked"!==t.status){if("expired"===t.status){alert("Ëøô‰∏™ÂÆùÁÆ±Â∑≤ËøáÊúüÔºåÂÆåÊàê‰ªäÊó•ÊåëÊàòÂèØËé∑ÂæóÊñ∞ÁöÑÂÆùÁÆ±„ÄÇ");var a=(0,l.Z)((0,l.Z)({},r),{},{"pendingChest":null});return(0,x.Uv)(a),void $()}if("unlocked"===t.status){var o=(0,x.lj)();if(!o)return;var i=o.levels.map(function(t){return(0,b.PR)(t)}),c=o.levels.length>1?"Â∑≤È¢ÜÂèñÔºö".concat(i.map(function(t){return t.emoji}).join(" + ")):"Â∑≤È¢ÜÂèñÔºö".concat(i[0].emoji," ").concat(i[0].name);alert(c),$()}}else alert("ÂÆùÁÆ±Ëß£ÈîÅÂÄíËÆ°Êó∂Ôºö".concat(L))}},ee=function renderTooltip(t){var a=(0,b.Ge)(t)[0],r=(0,b.PR)(t);return(0,m.jsxs)(c.G7,{"className":"chest-tooltip","onClick":function onClick(t){return t.stopPropagation()},"children":[(0,m.jsxs)(c.xv,{"className":"tooltip-title","children":[r.emoji," ",r.name,":"]}),(0,m.jsxs)(c.G7,{"className":"tooltip-rewards","children":[(0,m.jsxs)(c.xv,{"className":"tooltip-item","children":["ÈáëÂ∏ÅÔºö",a.coins]}),(0,m.jsxs)(c.xv,{"className":"tooltip-item","children":["ÈÅìÂÖ∑Ôºö",a.props]}),a.lottery&&(0,m.jsxs)(c.xv,{"className":"tooltip-item","children":["ÊäΩÂ•ñÂà∏Ôºö",a.lottery]}),a.physical&&(0,m.jsxs)(c.xv,{"className":"tooltip-item","children":["ÂÆûÁâ©Ôºö",a.physical]})]})]})};if(!r)return null;var te=w.chest?w.chest.levels.map(function(t){return(0,b.PR)(t)}):null,ne=w.chest?w.chest.levels:[],ae=function getCardDisplayContext(t,a,r){var o={"badgeText":"‰ªäÊó•‰ªªÂä°","energyLabel":"+".concat(a," ÊòüËÉΩ"),"chestStatLabel":r?"ÂÆùÁÆ± ".concat(r):void 0,"journeyHint":"ÊØèÂ§©Áé©‰∏ÄÂ±ÄÔºåÈÉΩ‰ºöÁªôÊòüÁêÉË°•ÂÖÖ‰∏ÄÁÇπÂÖâ„ÄÇ","startActionLabel":"ÂºÄÂßã‰ªäÊó•ÊåëÊàò","heroActionLabel":"ÊåëÊàòËã±ÈõÑÊ®°Âºè","doneActionLabel":"ÂâçÂæÄÊòüÊµ∑ÁªßÁª≠Êé¢Á¥¢","closeActionLabel":"ÂâçÂæÄÊòüÊµ∑ÁªßÁª≠Êé¢Á¥¢"};return"playing"===t?(0,l.Z)((0,l.Z)({},o),{},{"badgeText":"ËøõË°å‰∏≠","journeyHint":"ËøõÂ∫¶Â∑≤‰øùÂ≠òÔºåÁªßÁª≠Ëøô‰∏ÄÂ±ÄÂêß„ÄÇ","startActionLabel":"ÁªßÁª≠ÊåëÊàò"}):"completed"===t?(0,l.Z)((0,l.Z)({},o),{},{"badgeText":"Â∑≤ÈÄöÂÖ≥","chestStatLabel":void 0,"journeyHint":"ÂèØÁªßÁª≠ÊåëÊàòËã±ÈõÑÊ®°ÂºèÔºåÊàñÂÖàÂéªÊòüÊµ∑ÈÄõÈÄõ„ÄÇ"}):"hero"===t?(0,l.Z)((0,l.Z)({},o),{},{"badgeText":"Ëã±ÈõÑÊ®°ÂºèËøõË°å‰∏≠","chestStatLabel":void 0,"journeyHint":"Ëã±ÈõÑÊ®°ÂºèÂ§±Ë¥•‰∏ç‰ºöÊâ£ÊéâÂü∫Á°ÄÂÆùÁÆ±ÔºåËØ∑ÊîæÂøÉÊåëÊàò„ÄÇ"}):"done"===t?(0,l.Z)((0,l.Z)({},o),{},{"badgeText":"‰ªäÊó•ÂÆåÊàê","chestStatLabel":void 0,"journeyHint":"‰ªäÂ§©ÁöÑÊòüÂÖâÂ∑≤ÁÇπ‰∫ÆÔºåÂéªÊòüÊµ∑ÁúãÁúãÊñ∞ÁöÑÂèòÂåñÂêß„ÄÇ"}):o}(P,X.meta.energyReward,r.todayChestLevel||void 0);return(0,m.jsxs)(c.G7,{"className":"starlight starlight--".concat(P),"children":[(0,m.jsxs)(c.G7,{"className":"starlight__header","children":[(0,m.jsxs)(c.G7,{"className":"streak-badge","children":[(0,m.jsx)(c.xv,{"className":"streak-badge__icon","children":"üî•"}),(0,m.jsx)(c.xv,{"className":"streak-badge__count","children":r.consecutiveDays})]}),false]}),(0,m.jsxs)(c.G7,{"className":"starlight__planet","children":[(0,m.jsx)(d.Z,{"progress":N,"size":"large","onClick":function handlePlanetClick(){u.ZP.navigateTo({"url":"/pages/world/index"})}}),(0,m.jsx)(c.xv,{"className":"explore-hint","children":"ÁÇπÂáªÊòüÁêÉÂèØËøõÂÖ•Êé¢Á¥¢"})]}),(0,m.jsxs)(c.G7,{"className":"starlight__chest","children":["none"===w.status&&(0,m.jsxs)(c.G7,{"className":"chest-empty","children":[(0,m.jsx)(c.xv,{"className":"empty-title","children":"ÊöÇÊó†ÂÆùÁÆ±"}),(0,m.jsx)(c.xv,{"className":"empty-text","children":"ÂÆåÊàê‰ªäÊó•ÊåëÊàòÂêéÔºåÂ∞ÜËé∑Âæó‰∏ã‰∏ÄÈò∂ÊÆµÂ•ñÂä±ÂÆùÁÆ±„ÄÇ"})]}),"expired"===w.status&&(0,m.jsxs)(c.G7,{"className":"chest-empty chest-empty--expired","onClick":Q,"children":[(0,m.jsx)(c.xv,{"className":"empty-title","children":"ÂÆùÁÆ±Â∑≤ËøáÊúü"}),(0,m.jsx)(c.xv,{"className":"empty-text","children":"ËØ•ÂÆùÁÆ±ÁöÑÈ¢ÜÂèñÊó∂Èó¥Â∑≤ÁªìÊùü„ÄÇ"})]}),("locked"===w.status||"unlocked"===w.status)&&te&&(0,m.jsxs)(c.G7,{"className":"chest-card ".concat("locked"===w.status?"chest-card--locked":"chest-card--unlocked"),"onClick":Q,"children":[(0,m.jsx)(c.xv,{"className":"chest-card__label","children":"locked"===w.status?"Ë°•ÁªôÂÆùÁÆ±ËøêËæì‰∏≠":"ÊòüÂÖâÂÆùÁÆ±Â∑≤Â∞±Áª™"}),(0,m.jsx)(c.G7,{"className":"chest-card__icons","children":te.map(function(t,a){return(0,m.jsxs)(c.G7,{"className":"chest-icon-wrapper","onClick":function onClick(t){return function handleChestTooltip(t,a){a.stopPropagation(),E(z===t?null:t)}(a,t)},"children":[(0,m.jsx)(c.xv,{"className":"chest-icon","children":t.emoji}),z===a&&ee(ne[a])]},a)})}),(0,m.jsx)(c.xv,{"className":"chest-name","children":te.length>1?te.map(function(t){return t.name}).join(" + "):te[0].name}),(0,m.jsx)(c.xv,{"className":"expire-hint","children":"locked"===w.status?"Ëß£ÈîÅÂÄíËÆ°Êó∂ ".concat(L):"ÁÇπÂáªÈ¢ÜÂèñÂ•ñÂä±"}),"unlocked"===w.status&&(0,m.jsx)(c.zx,{"className":"claim-btn","onClick":Q,"children":"È¢ÜÂèñ"})]})]}),(0,m.jsx)(c.G7,{"className":"starlight__mission","children":(0,m.jsx)(h,{"meta":X.meta,"cardState":P,"display":ae,"onStart":function handleStart(){g.W.append({"userId":k,"date":W,"event":"starlight_cta_clicked","metadata":{"cardState":P,"ctaType":"start","gameType":X.id}}),H("playing"),u.ZP.navigateTo({"url":"/pages/game/index?mode=normal&gameType=".concat(X.id)})},"onHero":function handleHero(){g.W.append({"userId":k,"date":W,"event":"starlight_cta_clicked","metadata":{"cardState":P,"ctaType":"hero","gameType":X.id}}),g.W.append({"userId":k,"date":W,"event":"hero_prompt_clicked","metadata":{"gameType":X.id}}),H("hero"),u.ZP.navigateTo({"url":"/pages/game/index?mode=hero&gameType=".concat(X.id)})},"onExit":function handleGoToStarOcean(){g.W.append({"userId":k,"date":W,"event":"starlight_cta_clicked","metadata":{"cardState":P,"ctaType":"starocean","gameType":X.id}}),function navigateToStarOcean(){u.ZP.switchTab({"url":"/pages/starocean/index","fail":function fail(t){console.error("Navigation to starocean failed:",t),u.ZP.navigateTo({"url":"/pages/starocean/index","fail":function fail(t){console.error("Fallback navigateTo starocean failed:",t),u.ZP.reLaunch({"url":"/pages/starocean/index"})}})}})}()},"feedbackSlot":null})}),(0,m.jsx)(c.G7,{"className":"starlight__milestones","children":(0,m.jsx)(p,{"currentDays":r.consecutiveDays,"milestones":[{"days":7,"label":"7Â§©Â•ñÂä±"},{"days":14,"label":"14Â§©Ë¥¥Á∫∏"},{"days":30,"label":"30Â§©ÊåÇ‰ª∂"},{"days":60,"label":"60Â§©Á§ºÁõí"}]})})]})}},"7118":function(t,a,r){r.d(a,{"W":function(){return d}});var o=r(7853),l="amio_ui_event_logs_v1",i=function generateEventId(){return"".concat(Date.now(),"-").concat(Math.random().toString(36).slice(2,10))},c=function loadEvents(){if(!function hasStorageReader(){return"function"==typeof o.qu}())return[];try{var t=(0,o.qu)(l);return t?JSON.parse(t):[]}catch(t){return console.error("Failed to load UI event logs:",t),[]}},u=function saveEvents(t){if(function hasStorageWriter(){return"function"==typeof o.Fj}())try{(0,o.Fj)(l,JSON.stringify(t))}catch(t){console.error("Failed to save UI event logs:",t)}},d={"append":function append(t){var a=c();a.push({"id":i(),"userId":t.userId,"date":t.date,"event":t.event,"timestamp":Date.now(),"metadata":t.metadata}),u(a)},"listByUser":function listByUser(t){return c().filter(function(a){return a.userId===t})},"listByEvent":function listByEvent(t){return c().filter(function(a){return a.event===t})},"clear":function clear(){if(function hasStorageRemover(){return"function"==typeof o.hq}())try{(0,o.hq)(l)}catch(t){console.error("Failed to clear UI event logs:",t)}},"storageKey":l}},"6891":function(t,a,r){r.d(a,{"Ge":function(){return getChestRewardDetails},"HS":function(){return calculateChestLevel},"PR":function(){return getChestLevelInfo},"bV":function(){return upgradeChestForHero},"ns":function(){return createInitialStats}});var o=r(5961);function calculateChestLevel(t){var a=t.attempts,r=t.toolsUsed;return 1===a?0===r?o.q2.DIAMOND:1===r?o.q2.GOLD:o.q2.SILVER:2===a?r<=1?o.q2.GOLD:o.q2.SILVER:3===a?r<=2?o.q2.SILVER:o.q2.BRONZE:a>=4&&a<=5&&r<=1?o.q2.SILVER:o.q2.BRONZE}function getChestLevelInfo(t){switch(t){case o.q2.DIAMOND:return{"emoji":"üíé","name":"ÈíªÁü≥ÂÆùÁÆ±","color":"#00D4FF"};case o.q2.GOLD:return{"emoji":"ü•á","name":"ÈªÑÈáëÂÆùÁÆ±","color":"#FFD700"};case o.q2.SILVER:return{"emoji":"ü•à","name":"ÁôΩÈì∂ÂÆùÁÆ±","color":"#C0C0C0"};case o.q2.BRONZE:return{"emoji":"ü•â","name":"ÈùíÈìúÂÆùÁÆ±","color":"#CD7F32"}}}function getChestRewardDetails(t){switch(t){case o.q2.DIAMOND:return[{"coins":"ÈáëÂ∏Å√ó500","props":"ÈÅìÂÖ∑√ó3","lottery":"ÊäΩÂ•ñÂà∏√ó2","physical":"10%ÂÆû‰ΩìÂë®Ëæπ"}];case o.q2.GOLD:return[{"coins":"ÈáëÂ∏Å√ó300","props":"ÈÅìÂÖ∑√ó2","lottery":"ÊäΩÂ•ñÂà∏√ó1","physical":"3%ÂÆû‰ΩìÂë®Ëæπ"}];case o.q2.SILVER:return[{"coins":"ÈáëÂ∏Å√ó150","props":"ÈÅìÂÖ∑√ó1","lottery":"5%ÊäΩÂ•ñÂà∏","physical":""}];case o.q2.BRONZE:return[{"coins":"ÈáëÂ∏Å√ó50","props":"ÈÅìÂÖ∑Á¢éÁâá","lottery":"","physical":""}]}}function upgradeChestForHero(t){switch(t){case o.q2.BRONZE:return[o.q2.GOLD];case o.q2.SILVER:return[o.q2.DIAMOND];case o.q2.GOLD:return[o.q2.DIAMOND,o.q2.GOLD];case o.q2.DIAMOND:return[o.q2.DIAMOND,o.q2.DIAMOND]}}function createInitialStats(){return{"attempts":1,"toolsUsed":0,"undoUsed":!1,"shuffleUsed":!1,"popUsed":!1}}}}]);