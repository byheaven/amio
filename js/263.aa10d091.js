"use strict";(self.webpackJsonp=self.webpackJsonp||[]).push([[263],{"5263":function(e,t,n){n.r(t),n.d(t,{"default":function(){return R}});var s=n(2982),r=n(1413),a=n(885),o=n(7294),l=n(2432),i=n(4536),c={"star":'<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" fill="#FFD700" stroke="#E6C200" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>',"shark":'<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 14C22 14 19 14 18 11C18 11 15 13 13 13C11 13 10 11 10 11C10 11 7 13 4 13C2 13 2 17 2 17C2 17 6 19 12 19C18 19 22 17 22 17V14Z" fill="#00BFFF" stroke="#009ACD" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><circle cx="15" cy="14" r="1" fill="white"/><path d="M10 8L12 11H8L10 8Z" fill="#00BFFF" stroke="#009ACD" stroke-width="1"/></svg>',"bamboo":'<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="4" width="6" height="16" rx="1" fill="#90EE90" stroke="#228B22" stroke-width="2"/><path d="M9 10H15" stroke="#228B22" stroke-width="2"/><path d="M9 14H15" stroke="#228B22" stroke-width="2"/><path d="M10 4V2M14 4V2" stroke="#228B22" stroke-width="2" stroke-linecap="round"/></svg>',"dot":'<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="6" fill="#FF6347" stroke="#CD5C5C" stroke-width="2"/><circle cx="12" cy="12" r="2" fill="white"/></svg>',"character":'<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="4" y="4" width="16" height="16" rx="2" fill="#FFB6C1" stroke="#FF69B4" stroke-width="2"/><path d="M8 8H16M12 8V16M8 16H16" stroke="#C71585" stroke-width="2" stroke-linecap="round"/></svg>',"racket":'<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="10" r="6" fill="#FF4500" stroke="#8B0000" stroke-width="2"/><path d="M12 16V22" stroke="#8B0000" stroke-width="3" stroke-linecap="round"/><path d="M10 22H14" stroke="#8B0000" stroke-width="3" stroke-linecap="round"/></svg>',"medal":'<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="14" r="5" fill="#FFD700" stroke="#DAA520" stroke-width="2"/><path d="M12 14L9 4H15L12 14Z" fill="#DAA520" stroke="#DAA520" stroke-width="1"/><path d="M8 4L7 2H17L16 4" stroke="#DAA520" stroke-width="2"/></svg>',"heart":'<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.04L12 21.35Z" fill="#DC143C" stroke="#8B0000" stroke-width="2"/></svg>',"pingpong":'<svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="8" fill="#FFFFFF" stroke="#D3D3D3" stroke-width="1"/><circle cx="12" cy="12" r="7" stroke="#FFA500" stroke-width="1"/></svg>'},h=n(5893),d=function Tile(e){var t=e.data,n=e.onClick,s=e.width,r=void 0===s?60:s,a=e.height,o=void 0===a?66:a,i=t.type,d=t.isClickable,u=c[i];return(0,h.jsx)(l.G7,{"className":"tile ".concat(d?"":"disabled"),"style":{"width":"".concat(r,"px"),"height":"".concat(o,"px")},"onClick":function handleClick(){d&&n(t)},"children":u?(0,h.jsx)(l.G7,{"className":"icon-container","dangerouslySetInnerHTML":{"__html":u}}):(0,h.jsx)(l.xv,{"className":"content","children":i})})},u=function Board(e){var t=e.tiles,n=e.onTileClick;return(0,h.jsx)(l.G7,{"className":"board","children":(0,h.jsx)(l.G7,{"className":"board-container","children":(0,h.jsx)(l.G7,{"className":"tiles-area","children":t.map(function(e){return(0,h.jsx)(l.G7,{"className":"tile-wrapper","style":{"left":"".concat(36*e.x,"px"),"top":"".concat(32*e.y,"px"),"zIndex":e.layer},"children":(0,h.jsx)(d,{"data":e,"onClick":n,"width":40,"height":44})},e.id)})})})})},f=n(5961),m=function Slot(e){var t=e.tiles,n=Array(f.j$).fill(null).map(function(e,n){return t[n]||null});return(0,h.jsx)(l.G7,{"className":"slot-bar","children":n.map(function(e,t){return(0,h.jsx)(l.G7,{"className":"slot-cell","children":e&&(0,h.jsx)(d,{"data":(0,r.Z)((0,r.Z)({},e),{},{"isClickable":!1}),"onClick":function onClick(){},"width":32,"height":36})},"slot-".concat(t))})})},x=function TempSlot(e){var t=e.stacks,n=e.onStackClick;return t.some(function(e){return e.length>0})?(0,h.jsx)(l.G7,{"className":"temp-slot","children":t.map(function(e,t){return(0,h.jsxs)(l.G7,{"className":"temp-position","onClick":function onClick(){return e.length>0&&n(t)},"children":[e.map(function(t,n){return(0,h.jsx)(l.G7,{"className":"stacked-tile","style":{"zIndex":n,"transform":"translate(-50%, calc(-50% - ".concat(4*n,"px))")},"children":(0,h.jsx)(d,{"data":(0,r.Z)((0,r.Z)({},t),{},{"isClickable":n===e.length-1}),"onClick":function onClick(){},"width":32,"height":36})},t.id)}),0===e.length&&(0,h.jsx)(l.G7,{"className":"empty-slot"})]},t)})}):null},p=function UndoIcon(){return(0,h.jsxs)("svg",{"width":"20","height":"20","viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":"2","strokeLinecap":"round","strokeLinejoin":"round","children":[(0,h.jsx)("path",{"d":"M3 7v6h6"}),(0,h.jsx)("path",{"d":"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"})]})},v=function PopIcon(){return(0,h.jsxs)("svg",{"width":"20","height":"20","viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":"2","strokeLinecap":"round","strokeLinejoin":"round","children":[(0,h.jsx)("path",{"d":"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,h.jsx)("polyline",{"points":"17 8 12 3 7 8"}),(0,h.jsx)("line",{"x1":"12","y1":"3","x2":"12","y2":"15"})]})},g=function ShuffleIcon(){return(0,h.jsxs)("svg",{"width":"20","height":"20","viewBox":"0 0 24 24","fill":"none","stroke":"currentColor","strokeWidth":"2","strokeLinecap":"round","strokeLinejoin":"round","children":[(0,h.jsx)("polyline",{"points":"16 3 21 3 21 8"}),(0,h.jsx)("line",{"x1":"4","y1":"20","x2":"21","y2":"3"}),(0,h.jsx)("polyline",{"points":"21 16 21 21 16 21"}),(0,h.jsx)("line",{"x1":"15","y1":"15","x2":"21","y2":"21"}),(0,h.jsx)("line",{"x1":"4","y1":"4","x2":"9","y2":"9"})]})},y=function ToolBar(e){var t=e.onUndo,n=e.onShuffle,s=e.onRemove,r=e.undoDisabled,a=void 0!==r&&r,o=e.shuffleDisabled,i=void 0!==o&&o,c=e.removeDisabled,d=void 0!==c&&c;return(0,h.jsxs)(l.G7,{"className":"tool-bar","children":[(0,h.jsxs)(l.G7,{"className":"tool-btn ".concat(a?"disabled":""),"onClick":a?void 0:t,"children":[(0,h.jsx)(l.G7,{"className":"tool-icon","children":(0,h.jsx)(p,{})}),(0,h.jsx)(l.xv,{"className":"tool-name","children":"æ’¤å›"}),(0,h.jsx)(l.xv,{"className":"tool-count","children":a?"0/1":"1/1"})]}),(0,h.jsxs)(l.G7,{"className":"tool-btn ".concat(d?"disabled":""),"onClick":d?void 0:s,"children":[(0,h.jsx)(l.G7,{"className":"tool-icon","children":(0,h.jsx)(v,{})}),(0,h.jsx)(l.xv,{"className":"tool-name","children":"ç§»å‡º"}),(0,h.jsx)(l.xv,{"className":"tool-count","children":d?"0/1":"1/1"})]}),(0,h.jsxs)(l.G7,{"className":"tool-btn ".concat(i?"disabled":""),"onClick":i?void 0:n,"children":[(0,h.jsx)(l.G7,{"className":"tool-icon","children":(0,h.jsx)(g,{})}),(0,h.jsx)(l.xv,{"className":"tool-name","children":"æ´—ç‰Œ"}),(0,h.jsx)(l.xv,{"className":"tool-count","children":i?"0/1":"1/1"})]})]})},w=n(6891),j=function ChestModal(e){var t=e.chestLevels,n=e.stats,s=e.gameMode,r=e.canChallengeHero,a=e.onClaim,o=e.onHeroChallenge,i=s===f.GF.HERO,c=t.map(function(e){return(0,w.PR)(e)}),d=(0,w.bV)(t[0]).map(function(e){return(0,w.PR)(e)});return(0,h.jsx)(l.G7,{"className":"chest-modal-overlay","children":(0,h.jsxs)(l.G7,{"className":"chest-modal","children":[(0,h.jsx)(l.xv,{"className":"victory-text","children":i?"ğŸ† Heroé€šå…³ï¼":"ğŸ‰ æ­å–œé€šå…³ï¼"}),(0,h.jsxs)(l.G7,{"className":"chest-container","children":[(0,h.jsx)(l.G7,{"className":"chest-row","children":c.map(function(e,n){return(0,h.jsx)(l.G7,{"className":"chest-display chest-".concat(t[n]),"style":{"borderColor":e.color},"children":(0,h.jsx)(l.xv,{"className":"chest-emoji","children":e.emoji})},n)})}),(0,h.jsx)(l.xv,{"className":"chest-name","style":{"color":c[0].color},"children":t.length>1?"".concat(c.map(function(e){return e.name}).join(" + ")):c[0].name}),i&&(0,h.jsx)(l.xv,{"className":"hero-bonus","children":"ğŸ”¥ HeroåŠ æˆç”Ÿæ•ˆï¼"})]}),(0,h.jsxs)(l.G7,{"className":"stats-container","children":[(0,h.jsxs)(l.G7,{"className":"stat-item","children":[(0,h.jsx)(l.xv,{"className":"stat-label","children":"æŒ‘æˆ˜æ¬¡æ•°"}),(0,h.jsxs)(l.xv,{"className":"stat-value","children":[n.attempts,"æ¬¡"]})]}),(0,h.jsxs)(l.G7,{"className":"stat-item","children":[(0,h.jsx)(l.xv,{"className":"stat-label","children":"é“å…·ä½¿ç”¨"}),(0,h.jsxs)(l.xv,{"className":"stat-value","children":[n.toolsUsed,"ä¸ª"]})]})]}),r&&(0,h.jsxs)(l.G7,{"className":"hero-section","children":[(0,h.jsx)(l.xv,{"className":"hero-title","children":"ğŸ”¥ æŒ‘æˆ˜Heroæ¨¡å¼ï¼Ÿ"}),(0,h.jsxs)(l.xv,{"className":"hero-desc","children":["é€šå…³å¯å‡çº§ä¸º ",d.map(function(e){return"".concat(e.emoji," ").concat(e.name)}).join(" + ")]}),(0,h.jsx)(l.xv,{"className":"hero-warning","children":"âš ï¸ ä»…æœ‰1æ¬¡æœºä¼šï¼Œå¤±è´¥ä¸æ‰£å®ç®±"})]}),(0,h.jsx)(l.G7,{"className":"button-group","children":r?(0,h.jsxs)(h.Fragment,{"children":[(0,h.jsx)(l.zx,{"className":"btn-secondary","onClick":a,"children":"é¢†å–å®ç®±"}),(0,h.jsx)(l.zx,{"className":"btn-primary","onClick":o,"children":"æŒ‘æˆ˜Heroï¼"})]}):(0,h.jsx)(l.zx,{"className":"btn-primary full-width","onClick":a,"children":"é¢†å–å®ç®±"})})]})})},k=[{"day":1,"title":"æ¢¦æƒ³å¯èˆª","subtitle":"The Dream Begins","content":"äº”å²é‚£å¹´çš„å¤å¤©ï¼Œå°é¢–èç¬¬ä¸€æ¬¡èµ°è¿›äº†ä¹’ä¹“çƒé¦†ã€‚çœ‹ç€å¤§å­©å­ä»¬æŒ¥æ‹å‡»çƒçš„æ ·å­ï¼Œå¥¹çš„çœ¼ç›é‡Œé—ªçƒç€å¥½å¥‡çš„å…‰èŠ’ã€‚è¿™ä¸€å¤©ï¼Œä¸€é¢—å…³äºä¹’ä¹“çƒçš„ç§å­ï¼Œåœ¨å¥¹å¿ƒä¸­æ‚„ç„¶ç§ä¸‹ã€‚"},{"day":2,"title":"ç¬¬ä¸€æ¬¡æ¯”èµ›","subtitle":"First Competition","content":"çœé˜Ÿé€‰æ‹”èµ›ä¸Šï¼Œåä¸€å²çš„é¢–èç´§æ¡çƒæ‹ï¼Œæ‰‹å¿ƒå¾®å¾®å‡ºæ±—ã€‚å¯¹é¢æ˜¯æ¯”å¥¹å¤§ä¸¤å²çš„é€‰æ‰‹ï¼Œä½†å¥¹æ²¡æœ‰é€€ç¼©ã€‚ä¸€æ¿åˆä¸€æ¿ï¼Œæ¯ä¸€ä¸ªå›çƒéƒ½å‡èšç€å¥¹è‹¦ç»ƒçš„æ±—æ°´ã€‚æœ€ç»ˆï¼Œå¥¹èµ¢äº†ã€‚"},{"day":3,"title":"å›½å®¶é˜Ÿçš„é—¨","subtitle":"National Team Calling","content":"2015å¹´çš„é‚£ä¸ªç§‹å¤©ï¼Œåäº”å²çš„é¢–èæ”¶åˆ°äº†å›½å®¶é˜Ÿçš„é‚€è¯·ã€‚å½“å¥¹èµ°è¿›é‚£æ‰‡é—¨çš„æ—¶å€™ï¼Œå¥¹çŸ¥é“ï¼ŒçœŸæ­£çš„æŒ‘æˆ˜æ‰åˆšåˆšå¼€å§‹ã€‚è¿™é‡Œæœ‰æœ€å¼ºçš„å¯¹æ‰‹ï¼Œä¹Ÿæœ‰æœ€å¥½çš„è€å¸ˆã€‚"},{"day":4,"title":"ä½è°·ä¸æˆé•¿","subtitle":"Through the Valley","content":"è¿›å…¥å›½å®¶é˜Ÿçš„ç¬¬ä¸€å¹´å¹¶ä¸é¡ºåˆ©ã€‚è¾“çƒã€ä¼¤ç—…ã€æ€å¿µå®¶äºº...ä½†æ¯ä¸€æ¬¡è·Œå€’ï¼Œå¥¹éƒ½é€‰æ‹©çˆ¬èµ·æ¥ç»§ç»­ç»ƒä¹ ã€‚æ·±å¤œçš„è®­ç»ƒé¦†é‡Œï¼Œåªæœ‰å¥¹å’Œçƒåœ¨å¯¹è¯ã€‚"},{"day":5,"title":"ä¸–ç•Œèˆå°","subtitle":"World Stage","content":"2019å¹´ä¸–é”¦èµ›å¥³åŒå†³èµ›ï¼Œé¢–èå’Œæ­æ¡£é…åˆé»˜å¥‘ï¼Œä¸€è·¯è¿‡å…³æ–©å°†ã€‚å½“é‡‘ç‰ŒæŒ‚åœ¨èƒ¸å‰çš„é‚£ä¸€åˆ»ï¼Œå¥¹ç»ˆäºå¯ä»¥éª„å‚²åœ°è¯´ï¼šæˆ‘åšåˆ°äº†ã€‚"},{"day":6,"title":"å¥¥è¿æ¢¦åœ†","subtitle":"Olympic Dream","content":"ä¸œäº¬å¥¥è¿ä¼šçš„èµ›åœºä¸Šï¼Œé¢–èä»£è¡¨ä¸­å›½é˜Ÿç«™åœ¨äº†æœ€é«˜çš„èˆå°ã€‚è™½ç„¶å•æ‰“å†³èµ›æƒœè´¥ï¼Œä½†å¥¹ç”¨å®åŠ›è¯æ˜äº†è‡ªå·±çš„ä¸–ç•Œçº§æ°´å‡†ã€‚é“¶ç‰Œçš„é‡é‡ï¼Œæ˜¯æœªæ¥æ›´å¤§æ¢¦æƒ³çš„èµ·ç‚¹ã€‚"},{"day":7,"title":"ç‹è€…ä¹‹è·¯","subtitle":"Path of Champions","content":"2023å¹´ï¼Œé¢–èç™»é¡¶ä¸–ç•Œç¬¬ä¸€ã€‚ä»äº”å²çš„å°å¥³å­©åˆ°ä¸–ç•Œå† å†›ï¼Œå¥¹ç”¨åå…«å¹´çš„åšæŒè¯ é‡Šäº†ä»€ä¹ˆæ˜¯æ¢¦æƒ³çš„åŠ›é‡ã€‚è€Œè¿™ï¼Œåªæ˜¯å¼€å§‹..."}],N=function getStoryByDay(e){return k.find(function(t){return t.day===e})||null},C=function StoryModal(e){var t=e.storyDay,n=e.onComplete,s=(0,o.useState)(""),r=(0,a.Z)(s,2),i=r[0],c=r[1],d=(0,o.useState)(!1),u=(0,a.Z)(d,2),f=u[0],m=u[1],x=(0,o.useState)(!1),p=(0,a.Z)(x,2),v=p[0],g=p[1],y=N(t);(0,o.useEffect)(function(){if(y){var e=setTimeout(function(){g(!0)},1e3),t=y.content,s=0,r=setInterval(function(){s<t.length?(c(t.slice(0,s+1)),s++):(clearInterval(r),m(!0))},50);return function(){clearTimeout(e),clearInterval(r)}}n()},[y,n]);return y?(0,h.jsx)(l.G7,{"className":"story-modal-overlay","children":(0,h.jsxs)(l.G7,{"className":"story-modal","children":[(0,h.jsxs)(l.G7,{"className":"story-header","children":[(0,h.jsxs)(l.xv,{"className":"story-day","children":["Day ",t]}),(0,h.jsx)(l.xv,{"className":"story-title","children":y.title}),(0,h.jsx)(l.xv,{"className":"story-subtitle","children":y.subtitle})]}),(0,h.jsxs)(l.G7,{"className":"story-content","children":[(0,h.jsx)(l.xv,{"className":"story-text","children":i}),!f&&(0,h.jsx)(l.xv,{"className":"typing-cursor","children":"|"})]}),(0,h.jsxs)(l.G7,{"className":"story-actions","children":[v&&!f&&(0,h.jsx)(l.zx,{"className":"skip-btn","onClick":function handleSkip(){y&&(c(y.content),m(!0))},"children":"è·³è¿‡"}),f&&(0,h.jsx)(l.zx,{"className":"continue-btn","onClick":function handleContinue(){n()},"children":"ç»§ç»­ â†’"})]})]})}):null},S=function isTileBlocked(e,t){return t.some(function(t){if(t.id===e.id)return!1;if(t.layer<=e.layer)return!1;var n=Math.abs(t.x-e.x)<2,s=Math.abs(t.y-e.y)<2;return n&&s})},G=function updateClickableStatus(e){return e.map(function(t){return(0,r.Z)((0,r.Z)({},t),{},{"isClickable":!S(t,e)})})},D=function checkMatch(e){var t={};e.forEach(function(e){t[e.type]=(t[e.type]||0)+1});var n=Object.keys(t).find(function(e){return t[e]>=3});if(n){var s=0;return{"newSlots":e.filter(function(e){return!(e.type===n&&s<3)||(s++,!1)}),"matched":!0}}return{"newSlots":e,"matched":!1}},b=function getDailyLayoutSeed(){var e=new Date;return function hashString(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return Math.abs(t)}("".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0")))},M=function generateDailyLayout(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:75,n=function createSeededRandom(e){var t=e;return function(){return(t=1103515245*t+12345&2147483647)/2147483647}}(e),s=[],r=0;r<t;r++)s.push({"x":Math.floor(9*n()),"y":Math.floor(12*n()),"layer":Math.floor(6*n())});return s.sort(function(e,t){return e.layer-t.layer}),s},Z=function assignRandomTileTypes(e){for(var t=Object.values(f.YU),n=Math.floor(e.length/3),s=[],r=0;r<n;r++){var a=t[Math.floor(Math.random()*t.length)];s.push(a,a,a)}for(var o=s.length-1;o>0;o--){var l=Math.floor(Math.random()*(o+1)),i=[s[l],s[o]];s[o]=i[0],s[l]=i[1]}var c=e.map(function(e,t){return{"id":"tile-".concat(t),"type":s[t]||f.YU.STAR,"x":e.x,"y":e.y,"layer":e.layer,"isClickable":!0}});return G(c)},L=function generateHeroLevel(e){var t=function generateHeroLayout(e){for(var t=function createSeededRandom(e){var t=e;return function(){return(t=1103515245*t+12345&2147483647)/2147483647}}(e+1e3),n=[],s=0;s<150;s++)n.push({"x":Math.floor(9*t()),"y":Math.floor(12*t()),"layer":Math.floor(8*t())});return n.sort(function(e,t){return e.layer-t.layer}),n}(e);return function assignHeroTileTypes(e){for(var t=Object.values(f.YU),n=[].concat(t),s=Math.floor(e.length/3),r=[],a=0;a<s;a++){var o=n[Math.floor(Math.random()*n.length)];r.push(o,o,o)}for(var l=r.length-1;l>0;l--){var i=Math.floor(Math.random()*(l+1)),c=[r[i],r[l]];r[l]=c[0],r[i]=c[1]}var h=e.map(function(e,t){return{"id":"hero-tile-".concat(t),"type":r[t]||f.YU.STAR,"x":e.x,"y":e.y,"layer":e.layer,"isClickable":!0}});return G(h)}(t)},F=n(5589),R=function Game(){var e=i.ZP.useRouter(),t=(0,o.useState)([]),n=(0,a.Z)(t,2),c=n[0],d=n[1],p=(0,o.useState)([]),v=(0,a.Z)(p,2),g=v[0],k=v[1],S=(0,o.useState)([[],[],[]]),R=(0,a.Z)(S,2),O=R[0],H=R[1],U=(0,o.useState)("playing"),E=(0,a.Z)(U,2),B=E[0],T=E[1],q=(0,o.useState)(f.GF.NORMAL),I=(0,a.Z)(q,2),A=I[0],V=I[1],z=(0,o.useState)((0,w.ns)()),P=(0,a.Z)(z,2),W=P[0],Y=P[1],$=(0,o.useState)([f.q2.BRONZE]),J=(0,a.Z)($,2),_=J[0],K=J[1],Q=(0,o.useState)(!1),X=(0,a.Z)(Q,2),ee=X[0],te=X[1],ne=(0,o.useState)(!1),se=(0,a.Z)(ne,2),re=se[0],ae=se[1],oe=(0,o.useState)(!1),le=(0,a.Z)(oe,2),ie=le[0],ce=le[1],he=(0,o.useState)(!1),de=(0,a.Z)(he,2),ue=de[0],fe=de[1],me=(0,o.useState)(0),xe=(0,a.Z)(me,2),pe=xe[0],ve=xe[1],ge=(0,o.useRef)([]),ye=(0,o.useRef)(0);(0,o.useEffect)(function(){var t=b();ye.current=t,ge.current=M(t,75);var n=e.params.mode,s="true"===e.params.autowin;if("hero"===n){var r,a=(null===(r=(0,F.yu)().pendingChest)||void 0===r||null===(r=r.levels)||void 0===r?void 0:r[0])||f.q2.BRONZE;K([a]);var o=L(t);d(o),k([]),H([[],[],[]]),T("playing"),V(f.GF.HERO),te(!0),ae(!0)}else we();s&&setTimeout(function(){Ne()},500)},[]);var we=function startNewGame(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Z(ge.current);d(t),k([]),H([[],[],[]]),T("playing"),ce(!1),e?Y(function(e){return(0,r.Z)((0,r.Z)({},e),{},{"toolsUsed":0,"undoUsed":!1,"shuffleUsed":!1,"popUsed":!1})}):(Y((0,w.ns)()),V(f.GF.NORMAL))},je=function handleRetry(){if(Y(function(e){return(0,r.Z)((0,r.Z)({},e),{},{"attempts":e.attempts+1})}),A===f.GF.HERO){var e=L(ye.current);d(e),k([]),H([[],[],[]]),T("playing"),ce(!1),Y(function(e){return(0,r.Z)((0,r.Z)({},e),{},{"toolsUsed":0,"undoUsed":!1,"shuffleUsed":!1,"popUsed":!1})})}else we(!0)},ke=function handleClaim(){console.log("handleClaim - heroAttempted:",ee,"gameMode:",A),(0,F.Z9)(_,A===f.GF.HERO),(0,F.gv)(W.attempts,!0,_[0],ee,A===f.GF.HERO&&"won"===B),ce(!1),T("won"),A===f.GF.HERO?i.ZP.switchTab({"url":"/pages/starocean/index","fail":function fail(e){console.error("Navigation to starocean failed:",e),i.ZP.reLaunch({"url":"/pages/starocean/index"})}}):i.ZP.switchTab({"url":"/pages/starlight/index","fail":function fail(e){console.error("Navigation to starlight failed:",e),i.ZP.reLaunch({"url":"/pages/starlight/index"})}})},Ne=function handleTestWin(){if("playing"===B){var e;if(d([]),k([]),H([[],[],[]]),T("won"),A===f.GF.HERO){var t=(0,w.bV)(_[0]);K(t),e=t[0],ce(!0)}else{e=(0,w.HS)(W),K([e]),ae(!0);var n=(0,F.cn)(),s=N(n);n>0&&s?(ve(n),fe(!0)):ce(!0)}var r=(0,F.yu)();(0,F.EG)(A,e,r.consecutiveDays)}},Ce=re&&!ee;return(0,h.jsxs)(l.G7,{"className":"game-page ".concat(A===f.GF.HERO?"hero-mode":""),"children":[(0,h.jsxs)(l.G7,{"className":"header ".concat(A===f.GF.HERO?"hero-header":""),"children":[(0,h.jsxs)(l.G7,{"className":"stats-row","children":[(0,h.jsx)(l.xv,{"className":"day-text ".concat(A===f.GF.HERO?"hero-title":""),"children":A===f.GF.HERO?"ğŸ”¥ HERO MODE":"Day 1"}),(0,h.jsxs)(l.xv,{"className":"attempt-text ".concat(A===f.GF.HERO?"hero-attempt":""),"children":["ç¬¬ ",W.attempts," æ¬¡æŒ‘æˆ˜"]})]}),(0,h.jsxs)(l.G7,{"className":"header-right","children":[(0,h.jsx)(l.zx,{"className":"test-win-btn","onClick":Ne,"children":"ğŸ¯ ä¸€é”®è¿‡å…³"}),(0,h.jsx)(l.G7,{"className":"tools-status","children":(0,h.jsxs)(l.xv,{"children":["é“å…·: ",W.toolsUsed,"/3"]})})]})]}),(0,h.jsx)(u,{"tiles":c,"onTileClick":function handleTileClick(e){if("playing"===B&&!(g.length>=f.j$)){var t=c.filter(function(t){return t.id!==e.id}),n=G(t),r=[].concat((0,s.Z)(g),[e]);d(n),k(r);var a=D(r),o=a.newSlots;a.matched?k(o):o.length>=f.j$?T("lost"):k(o);var l=O.reduce(function(e,t){return e+t.length},0);if(0===n.length&&0===o.length&&0===l){var i,h;if(T("won"),A===f.GF.HERO)h=(0,w.bV)(_[0]),K(h),i=h[0],ce(!0);else{i=(0,w.HS)(W),K(h=[i]),ae(!0);var u=(0,F.cn)(),m=N(u);u>0&&m?(ve(u),fe(!0)):ce(!0)}var x=(0,F.yu)();(0,F.EG)(A,i,x.consecutiveDays)}}}}),(0,h.jsx)(x,{"stacks":O,"onStackClick":function handleTempStackClick(e){if("playing"===B){var t=function returnTileFromTempStack(e,t,n,r){if(t.length>=r)return{"newSlot":t,"newTempStacks":n,"success":!1};if(e<0||e>=n.length)return{"newSlot":t,"newTempStacks":n,"success":!1};if(0===n[e].length)return{"newSlot":t,"newTempStacks":n,"success":!1};var a=n.map(function(e){return(0,s.Z)(e)}),o=a[e].pop();return{"newSlot":[].concat((0,s.Z)(t),[o]),"newTempStacks":a,"success":!0}}(e,g,O,f.j$),n=t.newSlot,r=t.newTempStacks;if(t.success){H(r);var a=D(n),o=a.newSlots;a.matched?k(o):o.length>=f.j$?T("lost"):k(o)}}}}),(0,h.jsx)(m,{"tiles":g}),(0,h.jsx)(y,{"onUndo":function handleUndo(){if("playing"===B&&!W.undoUsed){var e=function undoLastTile(e,t){if(0===t.length)return{"newBoard":e,"newSlot":t,"success":!1};var n=t[t.length-1],r=t.slice(0,-1),a=[].concat((0,s.Z)(e),[n]);return{"newBoard":G(a),"newSlot":r,"success":!0}}(c,g),t=e.newBoard,n=e.newSlot;e.success&&(d(t),k(n),Y(function(e){return(0,r.Z)((0,r.Z)({},e),{},{"toolsUsed":e.toolsUsed+1,"undoUsed":!0})}))}},"onShuffle":function handleShuffle(){if("playing"===B&&!W.shuffleUsed){var e=function shuffleBoard(e){for(var t=e.map(function(e){return{"x":e.x,"y":e.y,"layer":e.layer}}),n=(0,s.Z)(t),a=n.length-1;a>0;a--){var o=Math.floor(Math.random()*(a+1)),l=[n[o],n[a]];n[a]=l[0],n[o]=l[1]}var i=e.map(function(e,t){return(0,r.Z)((0,r.Z)({},e),{},{"x":n[t].x,"y":n[t].y,"layer":n[t].layer})});return G(i)}(c);d(e),Y(function(e){return(0,r.Z)((0,r.Z)({},e),{},{"toolsUsed":e.toolsUsed+1,"shuffleUsed":!0})})}},"onRemove":function handleRemove(){if("playing"===B&&0!==g.length&&!W.popUsed){var e=function popTilesToTemp(e,t){if(0===e.length)return{"remainSlot":e,"newTempStacks":t,"success":!1};var n=Math.min(e.length,3),r=e.slice(0,n),a=e.slice(n),o=3===t.length?t.map(function(e){return(0,s.Z)(e)}):[[],[],[]];return r.forEach(function(e,t){o[t].push(e)}),{"remainSlot":a,"newTempStacks":o,"success":!0}}(g,O),t=e.remainSlot,n=e.newTempStacks;e.success&&(k(t),H(n),Y(function(e){return(0,r.Z)((0,r.Z)({},e),{},{"toolsUsed":e.toolsUsed+1,"popUsed":!0})}))}},"undoDisabled":W.undoUsed,"shuffleDisabled":W.shuffleUsed,"removeDisabled":W.popUsed}),ue&&(0,h.jsx)(C,{"storyDay":pe,"onComplete":function handleStoryComplete(){(0,F.OO)(pe),fe(!1),ce(!0)}}),ie&&"won"===B&&(0,h.jsx)(j,{"chestLevels":_,"stats":W,"gameMode":A,"canChallengeHero":Ce,"onClaim":ke,"onHeroChallenge":function startHeroMode(){var e=L(ye.current);d(e),k([]),H([[],[],[]]),T("playing"),ce(!1),V(f.GF.HERO),te(!0),Y(function(e){return(0,r.Z)((0,r.Z)({},e),{},{"toolsUsed":0,"undoUsed":!1,"shuffleUsed":!1,"popUsed":!1})})},"onClose":ke}),"lost"===B&&A===f.GF.NORMAL&&(0,h.jsx)(l.G7,{"className":"overlay","children":(0,h.jsxs)(l.G7,{"className":"lost-modal","children":[(0,h.jsx)(l.xv,{"className":"lost-title","children":"æŒ‘æˆ˜å¤±è´¥"}),(0,h.jsx)(l.xv,{"className":"lost-msg","children":"æ§½ä½å·²æ»¡ï¼Œæ— æ³•ç»§ç»­æ¶ˆé™¤"}),(0,h.jsxs)(l.xv,{"className":"lost-attempt","children":["æœ¬æ¬¡æŒ‘æˆ˜ï¼šç¬¬ ",W.attempts," æ¬¡"]}),(0,h.jsx)(l.zx,{"className":"retry-btn","onClick":je,"children":"å†æ¥ä¸€æ¬¡"})]})}),"lost"===B&&A===f.GF.HERO&&(0,h.jsx)(l.G7,{"className":"overlay","children":(0,h.jsxs)(l.G7,{"className":"lost-modal hero-lost","children":[(0,h.jsx)(l.xv,{"className":"lost-title","children":"HeroæŒ‘æˆ˜å¤±è´¥"}),(0,h.jsx)(l.xv,{"className":"lost-msg","children":"å†è¯•ä¸€æ¬¡ï¼Œæˆ–é¢†å–å½“å‰å®ç®±"}),(0,h.jsxs)(l.xv,{"className":"chest-keep","children":["å½“å‰ ",_[0]===f.q2.DIAMOND?"ğŸ’":_[0]===f.q2.GOLD?"ğŸ¥‡":_[0]===f.q2.SILVER?"ğŸ¥ˆ":"ğŸ¥‰"," å®ç®±"]}),(0,h.jsxs)(l.xv,{"className":"lost-attempt","children":["æœ¬æ¬¡æŒ‘æˆ˜ï¼šç¬¬ ",W.attempts," æ¬¡"]}),(0,h.jsx)(l.zx,{"className":"retry-btn","onClick":je,"children":"å†æ¥ä¸€æ¬¡"}),(0,h.jsx)(l.zx,{"className":"claim-btn-secondary","onClick":ke,"children":"é¢†å–å®ç®±"})]})})]})}},"6891":function(e,t,n){n.d(t,{"Ge":function(){return getChestRewardDetails},"HS":function(){return calculateChestLevel},"PR":function(){return getChestLevelInfo},"bV":function(){return upgradeChestForHero},"ns":function(){return createInitialStats}});var s=n(5961);function calculateChestLevel(e){var t=e.attempts,n=e.toolsUsed;return 1===t?0===n?s.q2.DIAMOND:1===n?s.q2.GOLD:s.q2.SILVER:2===t?n<=1?s.q2.GOLD:s.q2.SILVER:3===t?n<=2?s.q2.SILVER:s.q2.BRONZE:t>=4&&t<=5&&n<=1?s.q2.SILVER:s.q2.BRONZE}function getChestLevelInfo(e){switch(e){case s.q2.DIAMOND:return{"emoji":"ğŸ’","name":"é’»çŸ³å®ç®±","color":"#00D4FF"};case s.q2.GOLD:return{"emoji":"ğŸ¥‡","name":"é»„é‡‘å®ç®±","color":"#FFD700"};case s.q2.SILVER:return{"emoji":"ğŸ¥ˆ","name":"ç™½é“¶å®ç®±","color":"#C0C0C0"};case s.q2.BRONZE:return{"emoji":"ğŸ¥‰","name":"é’é“œå®ç®±","color":"#CD7F32"}}}function getChestRewardDetails(e){switch(e){case s.q2.DIAMOND:return[{"coins":"é‡‘å¸Ã—500","props":"é“å…·Ã—3","lottery":"æŠ½å¥–åˆ¸Ã—2","physical":"10%å®ä½“å‘¨è¾¹"}];case s.q2.GOLD:return[{"coins":"é‡‘å¸Ã—300","props":"é“å…·Ã—2","lottery":"æŠ½å¥–åˆ¸Ã—1","physical":"3%å®ä½“å‘¨è¾¹"}];case s.q2.SILVER:return[{"coins":"é‡‘å¸Ã—150","props":"é“å…·Ã—1","lottery":"5%æŠ½å¥–åˆ¸","physical":""}];case s.q2.BRONZE:return[{"coins":"é‡‘å¸Ã—50","props":"é“å…·ç¢ç‰‡","lottery":"","physical":""}]}}function upgradeChestForHero(e){switch(e){case s.q2.BRONZE:return[s.q2.GOLD];case s.q2.SILVER:return[s.q2.DIAMOND];case s.q2.GOLD:return[s.q2.DIAMOND,s.q2.GOLD];case s.q2.DIAMOND:return[s.q2.DIAMOND,s.q2.DIAMOND]}}function createInitialStats(){return{"attempts":1,"toolsUsed":0,"undoUsed":!1,"shuffleUsed":!1,"popUsed":!1}}}}]);