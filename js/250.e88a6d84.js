/*! For license information please see 250.e88a6d84.js.LICENSE.txt */
"use strict";(self.webpackJsonp=self.webpackJsonp||[]).push([[250],{"1872":function(e,t,r){r.d(t,{"zx":function(){return f},"xv":function(){return g},"G7":function(){return m}});var o=r(7294);const helper_manipulatePropsFunction=(e,t={})=>{const{"dangerouslySetInnerHTML":r,"style":o}=e;return"string"!=typeof o&&(t.style=o),Object.assign(Object.assign({},t),{"dangerouslySetInnerHTML":r})};var n=r(7210),a=r(7109);const i=(0,n.GH)(class extends n.mv{"constructor"(){super(),this.__registerHost(),this.onSubmit=(0,n.yM)(this,"tarobuttonsubmit",7),this.onReset=(0,n.yM)(this,"tarobuttonreset",7),this.disabled=void 0,this.hoverClass="button-hover",this.type="",this.hoverStartTime=20,this.hoverStayTime=70,this.size=void 0,this.plain=void 0,this.loading=!1,this.formType=null,this.hover=!1,this.touch=!1}"onClick"(e){this.disabled&&e.stopPropagation()}"onTouchStart"(){this.disabled||(this.touch=!0,this.hoverClass&&!this.disabled&&setTimeout(()=>{this.touch&&(this.hover=!0)},this.hoverStartTime))}"onTouchEnd"(){this.disabled||(this.touch=!1,this.hoverClass&&!this.disabled&&setTimeout(()=>{this.touch||(this.hover=!1)},this.hoverStayTime),"submit"===this.formType?this.onSubmit.emit():"reset"===this.formType&&this.onReset.emit())}"render"(){const{"disabled":e,"hoverClass":t,"type":r,"size":o,"plain":i,"loading":s,"hover":c}=this,l=(0,a.c)({[`${t}`]:c&&!e});return(0,n.h)(n.AA,{"class":l,"type":r,"plain":i,"loading":s,"size":o,"disabled":e},s&&(0,n.h)("i",{"class":"weui-loading"}),(0,n.h)("slot",null))}get"el"(){return this}static get"style"(){return".weui-loading{vertical-align:middle;background:url(\"data:image/svg+xml;charset=utf8, %3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 100 100'%3E%3Cpath fill='none' d='M0 0h100v100H0z'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23E9E9E9' rx='5' ry='5' transform='translate(0 -30)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23989697' rx='5' ry='5' transform='rotate(30 105.98 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%239B999A' rx='5' ry='5' transform='rotate(60 75.98 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23A3A1A2' rx='5' ry='5' transform='rotate(90 65 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23ABA9AA' rx='5' ry='5' transform='rotate(120 58.66 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23B2B2B2' rx='5' ry='5' transform='rotate(150 54.02 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23BAB8B9' rx='5' ry='5' transform='rotate(180 50 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23C2C0C1' rx='5' ry='5' transform='rotate(-150 45.98 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23CBCBCB' rx='5' ry='5' transform='rotate(-120 41.34 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23D2D2D2' rx='5' ry='5' transform='rotate(-90 35 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23DADADA' rx='5' ry='5' transform='rotate(-60 24.02 65)'/%3E%3Crect width='7' height='20' x='46.5' y='40' fill='%23E2E2E2' rx='5' ry='5' transform='rotate(-30 -5.98 65)'/%3E%3C/svg%3E\") 0 0/100% no-repeat;width:20px;height:20px;-webkit-animation:1s steps(12,end) infinite weuiLoading;animation:1s steps(12,end) infinite weuiLoading;display:inline-block}@-webkit-keyframes weuiLoading{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes weuiLoading{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.weui-btn_loading .weui-loading{margin:-.2em .34em 0 0}.weui-btn_loading.weui-btn_primary,.weui-btn_loading.weui-btn_warn{color:rgba(255,255,255,.6)}.weui-btn_loading.weui-btn_primary{background-color:#179b16}.weui-btn_loading.weui-btn_warn{background-color:#ce3c39}taro-button-core{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:none;-moz-appearance:none;appearance:none;text-align:center;color:#000;-webkit-tap-highlight-color:transparent;background-color:#f8f8f8;border-width:0;border-radius:5px;outline:0;width:100%;margin-left:auto;margin-right:auto;padding-left:14px;padding-right:14px;font-size:18px;line-height:2.55556;text-decoration:none;display:block;position:relative;overflow:hidden}taro-button-core:focus{outline:0}taro-button-core:not([disabled]):active{color:rgba(0,0,0,.6);background-color:#dedede}taro-button-core:after{-webkit-box-sizing:border-box;box-sizing:border-box;content:\" \";-webkit-transform-origin:0 0;transform-origin:0 0;border:1px solid rgba(0,0,0,.2);border-radius:10px;width:200%;height:200%;position:absolute;top:0;left:0;-webkit-transform:scale(.5);transform:scale(.5)}taro-button-core+taro-button-core{margin-top:15px}taro-button-core[type=default]{color:#000;background-color:#f8f8f8}taro-button-core[type=default]:not([disabled]):visited{color:#000}taro-button-core[type=default]:not([disabled]):active{color:rgba(0,0,0,.6);background-color:#dedede}taro-button-core[size=mini]{width:auto;padding:0 1.32em;font-size:13px;line-height:2.3;display:inline-block}taro-button-core[plain],taro-button-core[plain][type=default],taro-button-core[plain][type=primary]{background-color:transparent;border-width:1px}taro-button-core[disabled]{color:rgba(255,255,255,.6)}taro-button-core[disabled][type=default]{color:rgba(0,0,0,.3);background-color:#f7f7f7}taro-button-core[disabled][type=primary]{background-color:#9ed99d}taro-button-core[disabled][type=warn]{background-color:#ec8b89}taro-button-core[loading] .weui-loading{margin:-.2em .34em 0 0}taro-button-core[loading][type=primary],taro-button-core[loading][type=warn]{color:rgba(255,255,255,.6)}taro-button-core[loading][type=primary]{background-color:#179b16}taro-button-core[loading][type=warn]{background-color:#ce3c39}taro-button-core[plain][type=primary]{color:#1aad19;border:1px solid #1aad19}taro-button-core[plain][type=primary]:not([disabled]):active{color:rgba(26,173,25,.6);background-color:transparent;border-color:rgba(26,173,25,.6)}taro-button-core[plain][type=primary]:after{border-width:0}taro-button-core[plain][type=warn]{color:#e64340;border:1px solid #e64340}taro-button-core[plain][type=warn]:not([disabled]):active{color:rgba(230,67,64,.6);background-color:transparent;border-color:rgba(230,67,64,.6)}taro-button-core[plain][type=warn]:after{border-width:0}taro-button-core[plain],taro-button-core[plain][type=default]{color:#353535;border:1px solid #353535}taro-button-core[plain]:not([disabled]):active,taro-button-core[plain][type=default]:not([disabled]):active{color:rgba(53,53,53,.6);background-color:transparent;border-color:rgba(53,53,53,.6)}taro-button-core[plain]:after,taro-button-core[plain][type=default]:after{border-width:0}taro-button-core[type=primary]{color:#fff;background-color:#1aad19}taro-button-core[type=primary]:not([disabled]):visited{color:#fff}taro-button-core[type=primary]:not([disabled]):active{color:rgba(255,255,255,.6);background-color:#179b16}taro-button-core[type=warn]{color:#fff;background-color:#e64340}taro-button-core[type=warn]:not([disabled]):visited{color:#fff}taro-button-core[type=warn]:not([disabled]):active{color:rgba(255,255,255,.6);background-color:#ce3c39}taro-button-core[plain][disabled],taro-button-core[plain][disabled][type=primary]{color:rgba(0,0,0,.3);background-color:#f7f7f7;border:1px solid rgba(0,0,0,.2)}"}},[4,"taro-button-core",{"disabled":[4],"hoverClass":[1,"hover-class"],"type":[1],"hoverStartTime":[2,"hover-start-time"],"hoverStayTime":[2,"hover-stay-time"],"size":[1],"plain":[4],"loading":[4],"formType":[513,"form-type"],"hover":[32],"touch":[32]},[[0,"click","onClick"],[1,"touchstart","onTouchStart"],[1,"touchend","onTouchEnd"]]]);const s=function defineCustomElement$1(){if("undefined"==typeof customElements)return;["taro-button-core"].forEach(e=>{if("taro-button-core"===e)customElements.get(e)||customElements.define(e,i)})},c=(0,n.GH)(class extends n.mv{"constructor"(){super(),this.__registerHost(),this.selectable=!1,this.userSelect=!1,this.space=void 0,this.numberOfLines=void 0}"render"(){const e={};return"number"==typeof this.numberOfLines&&(e["--line-clamp"]=this.numberOfLines),(0,n.h)(n.AA,{"style":e},(0,n.h)("slot",null))}static get"style"(){return"taro-text-core{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:inline}taro-text-core[selectable=true],taro-text-core[user-select=true]{-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;display:inline-block}taro-text-core[space]{white-space:pre-wrap}taro-text-core[space=ensp]{word-spacing:.5em}taro-text-core[space=nbsp]{word-spacing:1em}taro-text-core[number-of-lines]{--line-clamp:2;word-wrap:break-word;text-overflow:ellipsis;-webkit-line-clamp:var(--line-clamp);-webkit-box-orient:vertical;display:-webkit-box;overflow:hidden}"}},[4,"taro-text-core",{"selectable":[1028],"userSelect":[1028,"user-select"],"space":[1025],"numberOfLines":[2,"number-of-lines"]}]);const l=function taro_text_core_defineCustomElement$1(){if("undefined"==typeof customElements)return;["taro-text-core"].forEach(e=>{if("taro-text-core"===e)customElements.get(e)||customElements.define(e,c)})};const d=(0,n.GH)(class extends n.mv{"constructor"(){super(),this.__registerHost(),this.onLongPress=(0,n.yM)(this,"longpress",7),this.startTime=0,this.animation=void 0,this.hoverClass=void 0,this.hoverStartTime=50,this.hoverStayTime=400,this.hover=!1,this.touch=!1}"onTouchStart"(){this.hoverClass&&(this.touch=!0,setTimeout(()=>{this.touch&&(this.hover=!0)},this.hoverStartTime)),this.timeoutEvent=setTimeout(()=>{this.onLongPress.emit()},350),this.startTime=Date.now()}"onTouchMove"(){clearTimeout(this.timeoutEvent)}"onTouchEnd"(){Date.now()-this.startTime<350&&clearTimeout(this.timeoutEvent),this.hoverClass&&(this.touch=!1,setTimeout(()=>{this.touch||(this.hover=!1)},this.hoverStayTime))}"componentDidRender"(){!function handleStencilNodes(e){var t;null===(t=null==e?void 0:e.childNodes)||void 0===t||t.forEach(e=>{e.nodeType===document.COMMENT_NODE&&e["s-cn"]&&(e["s-cn"]=!1),e.nodeType!==document.COMMENT_NODE&&e["s-sr"]&&(e["s-sr"]=!1)})}(this.el)}"render"(){const e=(0,a.c)({[`${this.hoverClass}`]:this.hover});let t={};return this.animation&&(t.animation=this.animation,t["data-animation"]=this.animation),(0,n.h)(n.AA,Object.assign({"class":e},t),(0,n.h)("slot",null))}get"el"(){return this}static get"style"(){return"body,html{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}taro-view-core{display:block}"}},[4,"taro-view-core",{"animation":[1],"hoverClass":[1,"hover-class"],"hoverStartTime":[2,"hover-start-time"],"hoverStayTime":[2,"hover-stay-time"],"hover":[32],"touch":[32]},[[1,"touchstart","onTouchStart"],[1,"touchmove","onTouchMove"],[1,"touchend","onTouchEnd"]]]);const u=function taro_view_core_defineCustomElement$1(){if("undefined"==typeof customElements)return;["taro-view-core"].forEach(e=>{if("taro-view-core"===e)customElements.get(e)||customElements.define(e,d)})};var h=r(7582);const mergeRefs=(...e)=>t=>{e.forEach(e=>{((e,t)=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})(e,t)})},camelToDashCase=e=>e.replace(/([A-Z])/g,e=>`-${e[0].toLowerCase()}`);var p=r(3935);const arrayToMap=e=>{const t=new Map;return e.forEach(e=>t.set(e,e)),t};function getComponentName(e){return e.tagName.replace(/^TARO-/,"").replace(/-CORE$/,"")}function getControlledValue(e){const t=getComponentName(e);return["INPUT","TEXTAREA","SLIDER","PICKER"].includes(t)?"value":"SWITCH"===t?"checked":null}function finishedEventHandler(e){const t=getControlledValue(e);if(!t)return;(0,p.flushSync)(()=>{});const r=function getPropsAfterReactUpdate(e){const t=Object.keys(e).find(e=>e.includes("__reactProps"));return t?e[t]:null}(e);(null==r?void 0:r.hasOwnProperty(t))&&r[t]!==e[t]&&(e[t]=r[t],e.setAttribute(t,r[t]))}const syncEvent=(e,t,r)=>{const o=e.__events||(e.__events={}),n=o[t];if(r){if(n){if(n.fn===r)return;e.removeEventListener(t,n)}const a=o[t]=function(t){(0,p.unstable_batchedUpdates)(()=>r.call(this,t)),finishedEventHandler(e)};a.fn=r,e.addEventListener(t,a)}else n&&e.removeEventListener(t,n)},attachProps=(e,t,r={})=>{if(e instanceof Element){Object.keys(r).forEach(r=>{if(!["style","children","ref","class","className","forwardedRef"].includes(r)&&!t.hasOwnProperty(r))if(/^on([A-Z].*)/.test(r)){const t=r.substring(2).toLowerCase();syncEvent(e,t)}else e[r]=null,e.removeAttribute(camelToDashCase(r))}),e.className=((e,t,r)=>{const o=t.className||t.class,n=r.className||r.class,a=arrayToMap(e),i=arrayToMap(o?o.split(" "):[]),s=arrayToMap(n?n.split(" "):[]),c=[];return a.forEach(e=>{i.has(e)?(c.push(e),i.delete(e)):s.has(e)||c.push(e)}),i.forEach(e=>c.push(e)),c.join(" ")})(e.classList,t,r),Object.keys(t).forEach(r=>{if(!("style"===r&&"string"!=typeof t[r]||["children","ref","class","className","forwardedRef"].includes(r)))if(/^on([A-Z].*)/.test(r)){const o=r.substring(2).toLowerCase();syncEvent(e,o,t[r])}else{e[r]=t[r];"string"===typeof t[r]&&e.setAttribute(camelToDashCase(r),t[r])}});const o=getControlledValue(e);if(o&&t.hasOwnProperty(o)){const t=["INPUT","TEXTAREA"].includes(getComponentName(e))?"input":"change";e.__events||(e.__events={}),e.__events.hasOwnProperty(t)||syncEvent(e,t,function(){})}}};const createComponent_createReactComponent=(e,t,r,n)=>{void 0!==n&&n();const a=e.toLowerCase().split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join("");const i=class extends o.Component{"constructor"(e){super(e),this.setComponentElRef=e=>{this.componentEl=e}}"componentDidMount"(){!function applyUnControlledDefaultValue(e,t){const r=getControlledValue(e);if(!r)return;const o="default"+r.charAt(0).toUpperCase()+r.slice(1);!t.hasOwnProperty(r)&&t.hasOwnProperty(o)&&(e[r]=t[o],e.setAttribute(r,t[o]))}(this.componentEl,this.props),this.componentDidUpdate(this.props)}"componentDidUpdate"(e){attachProps(this.componentEl,this.props,e)}"render"(){const t=this.props,{"children":n,"forwardedRef":a,"className":i,"ref":s,"style":c}=t,l=(0,h._T)(t,["children","forwardedRef","className","ref","style"]);let d=Object.keys(l).reduce((e,t)=>{const r=l[t];if(0===t.indexOf("on")&&t[2]===t[2].toUpperCase()){t.substring(2).toLowerCase();0}else{["string","boolean","number"].includes(typeof r)&&(e[camelToDashCase(t)]=r)}return e},{});r&&(d=r(this.props,d));const u=Object.assign(Object.assign({},d),{"ref":mergeRefs(a,this.setComponentElRef)});return(0,o.createElement)(e,u,n)}static get"displayName"(){return a}};return t&&(i.contextType=t),((e,t)=>{const forwardRef=(t,r)=>o.createElement(e,Object.assign({},t,{"forwardedRef":r}));return forwardRef.displayName=t,o.forwardRef(forwardRef)})(i,a)},f=createComponent_createReactComponent("taro-button-core",void 0,helper_manipulatePropsFunction,s),g=createComponent_createReactComponent("taro-text-core",void 0,helper_manipulatePropsFunction,l),m=createComponent_createReactComponent("taro-view-core",void 0,helper_manipulatePropsFunction,u)},"250":function(e,t,r){r.r(t);var o=r(885),n=r(7294),a=r(1872),i=r(3315),s=r(3826),c=r(5893);t.default=function IntroPage(){var e=(0,n.useState)(0),t=(0,o.Z)(e,2),r=t[0],l=t[1],d=(0,n.useState)(!1),u=(0,o.Z)(d,2),h=u[0],p=u[1],f=[{"en":"In the vast ocean of stars...","cn":"在浩瀚的星海之中……"},{"en":"A legend is whispered among the waves.","cn":"流传着一个关于波涛的传说。"},{"en":"The Shark Star.","cn":"那是……鲨之星。"},{"en":"It is said to bring fortune to those who dare to seek it.","cn":"传说它将为勇敢的寻觅者带来无尽的幸运。"},{"en":"Your journey begins now.","cn":"你的旅程，由此开始。"}];(0,n.useEffect)(function(){console.log("IntroPage mounted");try{var e=(0,s.yu)();console.log("IntroPage progress:",e),e&&e.hasSeenIntro?(console.log("Intro already seen, redirecting..."),g()):(console.log("Starting intro animation"),p(!0))}catch(e){console.error("Error in IntroPage useEffect:",e),g()}},[]);var g=function redirectToHome(){i.ZP.redirectTo({"url":"/pages/home/index"})},m=function finishIntro(){(0,s.i6)(),g()};return(0,c.jsxs)(a.G7,{"className":"intro-page","children":[(0,c.jsx)(a.G7,{"className":"story-container ".concat(h?"fade-in":"fade-out"),"children":(0,c.jsxs)(a.G7,{"className":"text-wrapper","children":[(0,c.jsx)(a.xv,{"className":"story-text-cn","children":f[r].cn}),(0,c.jsx)(a.xv,{"className":"story-text-en","children":f[r].en})]})}),(0,c.jsxs)(a.G7,{"className":"controls","children":[r<f.length-1?(0,c.jsx)(a.G7,{"className":"tap-hint","onClick":function handleNext(){r<f.length-1?(p(!1),setTimeout(function(){l(r+1),p(!0)},300)):m()},"children":(0,c.jsx)(a.xv,{"children":"点击继续"})}):(0,c.jsx)(a.zx,{"className":"start-btn","onClick":m,"children":"开启旅程"}),(0,c.jsx)(a.G7,{"className":"skip-btn","onClick":m,"children":(0,c.jsx)(a.xv,{"children":"跳过"})})]})]})}},"3826":function(e,t,r){r.d(t,{"lj":function(){return f},"f2":function(){return l},"dH":function(){return b},"zo":function(){return g},"cn":function(){return y},"Sh":function(){return m},"yu":function(){return d},"i6":function(){return w},"OO":function(){return v},"Z9":function(){return p},"Uv":function(){return u},"gv":function(){return h}});var o=r(1413),n=r(1002),a=r(7255);function getItem(e){var t;try{t=JSON.parse(localStorage.getItem(e)||"")}catch(e){}return t&&"object"===(0,n.Z)(t)&&t.hasOwnProperty("data")?{"result":!0,"data":t.data}:{"result":!1}}var i=function setStorageSync(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if("string"==typeof e){var r={};r="symbol"===(0,n.Z)(t)?{"data":""}:{"data":t},localStorage.setItem(e,JSON.stringify(r))}else console.error((0,a.Hl)({"name":"setStorage","correct":"String","wrong":e}))},s="amio_game_progress",c=function getTodayDateString(){var e=new Date;return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0"))},l=function createInitialProgress(){return{"todayDate":c(),"todayAttempts":0,"todayCompleted":!1,"todayChestLevel":null,"heroAttempted":!1,"heroCompleted":!1,"pendingChest":null,"consecutiveDays":0,"lastCompletionDate":null,"lastClaimDate":null,"totalDaysPlayed":0,"storyProgress":0,"viewedStories":[],"hasSeenIntro":!1}},d=function loadProgress(){try{var e=function getStorageSync(e){if("string"==typeof e){var t=getItem(e);return t.result?t.data:""}console.error((0,a.Hl)({"name":"getStorageSync","correct":"String","wrong":e}))}(s);if(e){var t=JSON.parse(e);if(t.pendingChest){var r=t.pendingChest;void 0!==r.level&&void 0===r.levels&&(r.levels=[r.level],delete r.level)}void 0===t.lastCompletionDate&&(t.lastCompletionDate=null),void 0===t.storyProgress&&(t.storyProgress=0),void 0===t.viewedStories&&(t.viewedStories=[]),void 0===t.hasSeenIntro&&(t.hasSeenIntro=!1);var n=c();if(t.todayDate!==n){var i=(0,o.Z)((0,o.Z)({},t),{},{"todayDate":n,"todayAttempts":0,"todayCompleted":!1,"todayChestLevel":null,"heroAttempted":!1,"heroCompleted":!1});return u(i),i}return t}}catch(e){console.error("Failed to load progress:",e)}return l()},u=function saveProgress(e){try{i(s,JSON.stringify(e))}catch(e){console.error("Failed to save progress:",e)}},h=function updateTodayStatus(e,t,r,o,n){var a=d(),i=a.todayCompleted,s=new Date,l=c();if(a.todayAttempts=e,a.todayCompleted=t,a.todayChestLevel=r,a.heroAttempted=o,a.heroCompleted=n,t&&!i){if(a.totalDaysPlayed+=1,a.lastCompletionDate){var h=new Date(s);h.setDate(h.getDate()-1);var p="".concat(h.getFullYear(),"-").concat(String(h.getMonth()+1).padStart(2,"0"),"-").concat(String(h.getDate()).padStart(2,"0"));a.lastCompletionDate===p?a.consecutiveDays+=1:a.lastCompletionDate!==l&&(a.consecutiveDays=1)}else a.consecutiveDays=1;a.lastCompletionDate=l}u(a)},p=function savePendingChest(e,t){var r=d(),o=new Date,n=c(),a=!1;if(r.pendingChest){var i=new Date(r.pendingChest.earnedAt);a="".concat(i.getFullYear(),"-").concat(String(i.getMonth()+1).padStart(2,"0"),"-").concat(String(i.getDate()).padStart(2,"0"))===n}if(r.pendingChest&&a)r.pendingChest.levels=e,r.pendingChest.isHeroBonus=t;else{var s=new Date(o.getTime()+864e5),l=new Date(s.getTime()+864e5);r.pendingChest={"levels":e,"earnedAt":o.toISOString(),"unlockAt":s.toISOString(),"expiresAt":l.toISOString(),"isHeroBonus":t}}u(r)},f=function claimChest(){var e=d(),t=e.pendingChest;if(!t)return null;var r=new Date,o=new Date(t.unlockAt),n=new Date(t.expiresAt);if(r<o)return console.log("Chest not yet unlocked"),null;if(r>n)return console.log("Chest expired"),e.pendingChest=null,u(e),null;var a=c();return e.lastClaimDate=a,e.pendingChest=null,u(e),t},g=function getChestStatus(){var e=d().pendingChest;if(!e)return{"status":"none","chest":null,"remainingTime":0};var t=new Date,r=new Date(e.unlockAt),o=new Date(e.expiresAt);return t>o?{"status":"expired","chest":e,"remainingTime":0}:t<r?{"status":"locked","chest":e,"remainingTime":r.getTime()-t.getTime()}:{"status":"unlocked","chest":e,"remainingTime":o.getTime()-t.getTime()}},m=function getStreakRewardInfo(e){for(var t=0,r=[{"days":7,"reward":"抽奖券×3"},{"days":14,"reward":"实体贴纸包"},{"days":30,"reward":"实体手链/挂件"},{"days":60,"reward":"限定礼盒"}];t<r.length;t++){var o=r[t];if(e<o.days)return{"nextMilestone":o.days,"daysRemaining":o.days-e,"reward":o.reward}}return null},b=function formatRemainingTime(e){var t=Math.floor(e/1e3),r=Math.floor(t/3600),o=Math.floor(t%3600/60),n=t%60;return"".concat(String(r).padStart(2,"0"),":").concat(String(o).padStart(2,"0"),":").concat(String(n).padStart(2,"0"))},y=function getNextStoryDay(){var e=d(),t=e.storyProgress+1;return e.viewedStories.includes(t)?0:t},v=function markStoryViewed(e){var t=d();t.viewedStories.includes(e)||t.viewedStories.push(e),e>t.storyProgress&&(t.storyProgress=e),u(t)},w=function markIntroSeen(){var e=d();e.hasSeenIntro=!0,u(e)}},"5251":function(e,t,r){var o=r(7294),n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={"key":!0,"ref":!0,"__self":!0,"__source":!0};function q(e,t,r){var o,a={},l=null,d=null;for(o in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,o)&&!c.hasOwnProperty(o)&&(a[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===a[o]&&(a[o]=t[o]);return{"$$typeof":n,"type":e,"key":l,"ref":d,"props":a,"_owner":s.current}}t.Fragment=a,t.jsx=q,t.jsxs=q},"5893":function(e,t,r){e.exports=r(5251)},"1413":function(e,t,r){r.d(t,{"Z":function(){return _objectSpread2}});var o=r(4942);function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){(0,o.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}}}]);