"use strict";(self.webpackJsonp=self.webpackJsonp||[]).push([[754],{"4754":function(e,t,n){n.r(t),n.d(t,{"default":function(){return R}});var s=n(2982),a=n(1413),l=n(885),r=n(7294),o=n(2432),c=n(4536),i=n(6107),u=n(5893),d=function Tile(e){var t=e.data,n=e.onClick,s=e.width,a=void 0===s?60:s,l=e.height,r=void 0===l?66:l,c=t.type,d=t.isClickable,h=(0,i.a2)(c);return(0,u.jsx)(o.G7,{"className":"tile ".concat(d?"":"disabled"),"style":{"width":"".concat(a,"px"),"height":"".concat(r,"px")},"onClick":function handleClick(){d&&n(t)},"children":h?(0,u.jsx)(o.G7,{"className":"icon-container","dangerouslySetInnerHTML":{"__html":h}}):(0,u.jsx)(o.xv,{"className":"content","children":c})})},h=function Board(e){var t=e.tiles,n=e.onTileClick;return(0,u.jsx)(o.G7,{"className":"board","children":(0,u.jsx)(o.G7,{"className":"board-container","children":(0,u.jsx)(o.G7,{"className":"tiles-area","children":t.map(function(e){return(0,u.jsx)(o.G7,{"className":"tile-wrapper","style":{"left":"".concat(36*e.x,"px"),"top":"".concat(32*e.y,"px"),"zIndex":e.layer},"children":(0,u.jsx)(d,{"data":e,"onClick":n,"width":40,"height":44})},e.id)})})})})},m=n(5961),f=function Slot(e){var t=e.tiles,n=Array(m.j$).fill(null).map(function(e,n){return t[n]||null});return(0,u.jsx)(o.G7,{"className":"slot-bar","children":n.map(function(e,t){return(0,u.jsx)(o.G7,{"className":"slot-cell","children":e&&(0,u.jsx)(d,{"data":(0,a.Z)((0,a.Z)({},e),{},{"isClickable":!1}),"onClick":function onClick(){},"width":32,"height":36})},"slot-".concat(t))})})},x=function TempSlot(e){var t=e.stacks,n=e.onStackClick;return t.some(function(e){return e.length>0})?(0,u.jsx)(o.G7,{"className":"temp-slot","children":t.map(function(e,t){return(0,u.jsxs)(o.G7,{"className":"temp-position","onClick":function onClick(){return e.length>0&&n(t)},"children":[e.map(function(t,n){return(0,u.jsx)(o.G7,{"className":"stacked-tile","style":{"zIndex":n,"transform":"translate(-50%, calc(-50% - ".concat(4*n,"px))")},"children":(0,u.jsx)(d,{"data":(0,a.Z)((0,a.Z)({},t),{},{"isClickable":n===e.length-1}),"onClick":function onClick(){},"width":32,"height":36})},t.id)}),0===e.length&&(0,u.jsx)(o.G7,{"className":"empty-slot"})]},t)})}):null},p=function ToolBar(e){var t=e.onUndo,n=e.onShuffle,s=e.onRemove,a=e.undoDisabled,l=void 0!==a&&a,r=e.shuffleDisabled,c=void 0!==r&&r,d=e.removeDisabled,h=void 0!==d&&d,m=(0,i.Hi)();return(0,u.jsxs)(o.G7,{"className":"tool-bar","children":[(0,u.jsxs)(o.G7,{"className":"tool-btn ".concat(l?"disabled":""),"onClick":l?void 0:t,"children":[(0,u.jsx)(o.G7,{"className":"tool-icon","dangerouslySetInnerHTML":{"__html":m.undo}}),(0,u.jsx)(o.xv,{"className":"tool-name","children":"æ’¤å›"}),(0,u.jsx)(o.xv,{"className":"tool-count","children":l?"0/1":"1/1"})]}),(0,u.jsxs)(o.G7,{"className":"tool-btn ".concat(h?"disabled":""),"onClick":h?void 0:s,"children":[(0,u.jsx)(o.G7,{"className":"tool-icon","dangerouslySetInnerHTML":{"__html":m.pop}}),(0,u.jsx)(o.xv,{"className":"tool-name","children":"ç§»å‡º"}),(0,u.jsx)(o.xv,{"className":"tool-count","children":h?"0/1":"1/1"})]}),(0,u.jsxs)(o.G7,{"className":"tool-btn ".concat(c?"disabled":""),"onClick":c?void 0:n,"children":[(0,u.jsx)(o.G7,{"className":"tool-icon","dangerouslySetInnerHTML":{"__html":m.shuffle}}),(0,u.jsx)(o.xv,{"className":"tool-name","children":"æ´—ç‰Œ"}),(0,u.jsx)(o.xv,{"className":"tool-count","children":c?"0/1":"1/1"})]})]})},v=n(6891),y=function ChestModal(e){var t=e.chestLevels,n=e.stats,s=e.gameMode,a=e.canChallengeHero,l=e.onClaim,r=e.onHeroChallenge,c=s===m.GF.HERO,i=t.map(function(e){return(0,v.PR)(e)}),d=(0,v.bV)(t[0]).map(function(e){return(0,v.PR)(e)});return(0,u.jsx)(o.G7,{"className":"chest-modal-overlay","children":(0,u.jsxs)(o.G7,{"className":"chest-modal","children":[(0,u.jsx)(o.xv,{"className":"victory-text","children":c?"ğŸ† Heroé€šå…³ï¼":"ğŸ‰ æ­å–œé€šå…³ï¼"}),(0,u.jsxs)(o.G7,{"className":"chest-container","children":[(0,u.jsx)(o.G7,{"className":"chest-row","children":i.map(function(e,n){return(0,u.jsx)(o.G7,{"className":"chest-display chest-".concat(t[n]),"style":{"borderColor":e.color},"children":(0,u.jsx)(o.xv,{"className":"chest-emoji","children":e.emoji})},n)})}),(0,u.jsx)(o.xv,{"className":"chest-name","style":{"color":i[0].color},"children":t.length>1?"".concat(i.map(function(e){return e.name}).join(" + ")):i[0].name}),c&&(0,u.jsx)(o.xv,{"className":"hero-bonus","children":"ğŸ”¥ HeroåŠ æˆç”Ÿæ•ˆï¼"})]}),(0,u.jsxs)(o.G7,{"className":"stats-container","children":[(0,u.jsxs)(o.G7,{"className":"stat-item","children":[(0,u.jsx)(o.xv,{"className":"stat-label","children":"æŒ‘æˆ˜æ¬¡æ•°"}),(0,u.jsxs)(o.xv,{"className":"stat-value","children":[n.attempts,"æ¬¡"]})]}),(0,u.jsxs)(o.G7,{"className":"stat-item","children":[(0,u.jsx)(o.xv,{"className":"stat-label","children":"é“å…·ä½¿ç”¨"}),(0,u.jsxs)(o.xv,{"className":"stat-value","children":[n.toolsUsed,"ä¸ª"]})]})]}),a&&(0,u.jsxs)(o.G7,{"className":"hero-section","children":[(0,u.jsx)(o.xv,{"className":"hero-title","children":"ğŸ”¥ æŒ‘æˆ˜Heroæ¨¡å¼ï¼Ÿ"}),(0,u.jsxs)(o.xv,{"className":"hero-desc","children":["é€šå…³å¯å‡çº§ä¸º ",d.map(function(e){return"".concat(e.emoji," ").concat(e.name)}).join(" + ")]}),(0,u.jsx)(o.xv,{"className":"hero-warning","children":"âš ï¸ ä»…æœ‰1æ¬¡æœºä¼šï¼Œå¤±è´¥ä¸æ‰£å®ç®±"})]}),(0,u.jsx)(o.G7,{"className":"button-group","children":a?(0,u.jsxs)(u.Fragment,{"children":[(0,u.jsx)(o.zx,{"className":"btn-secondary","onClick":l,"children":"é¢†å–å®ç®±"}),(0,u.jsx)(o.zx,{"className":"btn-primary","onClick":r,"children":"æŒ‘æˆ˜Heroï¼"})]}):(0,u.jsx)(o.zx,{"className":"btn-primary full-width","onClick":l,"children":"é¢†å–å®ç®±"})})]})})},j=[{"day":1,"title":"æ¢¦æƒ³å¯èˆª","subtitle":"The Dream Begins","content":"äº”å²é‚£å¹´çš„å¤å¤©ï¼Œå°é¢–èç¬¬ä¸€æ¬¡èµ°è¿›äº†ä¹’ä¹“çƒé¦†ã€‚çœ‹ç€å¤§å­©å­ä»¬æŒ¥æ‹å‡»çƒçš„æ ·å­ï¼Œå¥¹çš„çœ¼ç›é‡Œé—ªçƒç€å¥½å¥‡çš„å…‰èŠ’ã€‚è¿™ä¸€å¤©ï¼Œä¸€é¢—å…³äºä¹’ä¹“çƒçš„ç§å­ï¼Œåœ¨å¥¹å¿ƒä¸­æ‚„ç„¶ç§ä¸‹ã€‚"},{"day":2,"title":"ç¬¬ä¸€æ¬¡æ¯”èµ›","subtitle":"First Competition","content":"çœé˜Ÿé€‰æ‹”èµ›ä¸Šï¼Œåä¸€å²çš„é¢–èç´§æ¡çƒæ‹ï¼Œæ‰‹å¿ƒå¾®å¾®å‡ºæ±—ã€‚å¯¹é¢æ˜¯æ¯”å¥¹å¤§ä¸¤å²çš„é€‰æ‰‹ï¼Œä½†å¥¹æ²¡æœ‰é€€ç¼©ã€‚ä¸€æ¿åˆä¸€æ¿ï¼Œæ¯ä¸€ä¸ªå›çƒéƒ½å‡èšç€å¥¹è‹¦ç»ƒçš„æ±—æ°´ã€‚æœ€ç»ˆï¼Œå¥¹èµ¢äº†ã€‚"},{"day":3,"title":"å›½å®¶é˜Ÿçš„é—¨","subtitle":"National Team Calling","content":"2015å¹´çš„é‚£ä¸ªç§‹å¤©ï¼Œåäº”å²çš„é¢–èæ”¶åˆ°äº†å›½å®¶é˜Ÿçš„é‚€è¯·ã€‚å½“å¥¹èµ°è¿›é‚£æ‰‡é—¨çš„æ—¶å€™ï¼Œå¥¹çŸ¥é“ï¼ŒçœŸæ­£çš„æŒ‘æˆ˜æ‰åˆšåˆšå¼€å§‹ã€‚è¿™é‡Œæœ‰æœ€å¼ºçš„å¯¹æ‰‹ï¼Œä¹Ÿæœ‰æœ€å¥½çš„è€å¸ˆã€‚"},{"day":4,"title":"ä½è°·ä¸æˆé•¿","subtitle":"Through the Valley","content":"è¿›å…¥å›½å®¶é˜Ÿçš„ç¬¬ä¸€å¹´å¹¶ä¸é¡ºåˆ©ã€‚è¾“çƒã€ä¼¤ç—…ã€æ€å¿µå®¶äºº...ä½†æ¯ä¸€æ¬¡è·Œå€’ï¼Œå¥¹éƒ½é€‰æ‹©çˆ¬èµ·æ¥ç»§ç»­ç»ƒä¹ ã€‚æ·±å¤œçš„è®­ç»ƒé¦†é‡Œï¼Œåªæœ‰å¥¹å’Œçƒåœ¨å¯¹è¯ã€‚"},{"day":5,"title":"ä¸–ç•Œèˆå°","subtitle":"World Stage","content":"2019å¹´ä¸–é”¦èµ›å¥³åŒå†³èµ›ï¼Œé¢–èå’Œæ­æ¡£é…åˆé»˜å¥‘ï¼Œä¸€è·¯è¿‡å…³æ–©å°†ã€‚å½“é‡‘ç‰ŒæŒ‚åœ¨èƒ¸å‰çš„é‚£ä¸€åˆ»ï¼Œå¥¹ç»ˆäºå¯ä»¥éª„å‚²åœ°è¯´ï¼šæˆ‘åšåˆ°äº†ã€‚"},{"day":6,"title":"å¥¥è¿æ¢¦åœ†","subtitle":"Olympic Dream","content":"ä¸œäº¬å¥¥è¿ä¼šçš„èµ›åœºä¸Šï¼Œé¢–èä»£è¡¨ä¸­å›½é˜Ÿç«™åœ¨äº†æœ€é«˜çš„èˆå°ã€‚è™½ç„¶å•æ‰“å†³èµ›æƒœè´¥ï¼Œä½†å¥¹ç”¨å®åŠ›è¯æ˜äº†è‡ªå·±çš„ä¸–ç•Œçº§æ°´å‡†ã€‚é“¶ç‰Œçš„é‡é‡ï¼Œæ˜¯æœªæ¥æ›´å¤§æ¢¦æƒ³çš„èµ·ç‚¹ã€‚"},{"day":7,"title":"ç‹è€…ä¹‹è·¯","subtitle":"Path of Champions","content":"2023å¹´ï¼Œé¢–èç™»é¡¶ä¸–ç•Œç¬¬ä¸€ã€‚ä»äº”å²çš„å°å¥³å­©åˆ°ä¸–ç•Œå† å†›ï¼Œå¥¹ç”¨åå…«å¹´çš„åšæŒè¯ é‡Šäº†ä»€ä¹ˆæ˜¯æ¢¦æƒ³çš„åŠ›é‡ã€‚è€Œè¿™ï¼Œåªæ˜¯å¼€å§‹..."}],N=function getStoryByDay(e){return j.find(function(t){return t.day===e})||null},g=function StoryModal(e){var t=e.storyDay,n=e.onComplete,s=(0,r.useState)(""),a=(0,l.Z)(s,2),c=a[0],i=a[1],d=(0,r.useState)(!1),h=(0,l.Z)(d,2),m=h[0],f=h[1],x=(0,r.useState)(!1),p=(0,l.Z)(x,2),v=p[0],y=p[1],j=N(t);(0,r.useEffect)(function(){if(j){var e=setTimeout(function(){y(!0)},1e3),t=j.content,s=0,a=setInterval(function(){s<t.length?(i(t.slice(0,s+1)),s++):(clearInterval(a),f(!0))},50);return function(){clearTimeout(e),clearInterval(a)}}n()},[j,n]);return j?(0,u.jsx)(o.G7,{"className":"story-modal-overlay","children":(0,u.jsxs)(o.G7,{"className":"story-modal","children":[(0,u.jsxs)(o.G7,{"className":"story-header","children":[(0,u.jsxs)(o.xv,{"className":"story-day","children":["Day ",t]}),(0,u.jsx)(o.xv,{"className":"story-title","children":j.title}),(0,u.jsx)(o.xv,{"className":"story-subtitle","children":j.subtitle})]}),(0,u.jsxs)(o.G7,{"className":"story-content","children":[(0,u.jsx)(o.xv,{"className":"story-text","children":c}),!m&&(0,u.jsx)(o.xv,{"className":"typing-cursor","children":"|"})]}),(0,u.jsxs)(o.G7,{"className":"story-actions","children":[v&&!m&&(0,u.jsx)(o.zx,{"className":"skip-btn","onClick":function handleSkip(){j&&(i(j.content),f(!0))},"children":"è·³è¿‡"}),m&&(0,u.jsx)(o.zx,{"className":"continue-btn","onClick":function handleContinue(){n()},"children":"ç»§ç»­ â†’"})]})]})}):null},S=function isTileBlocked(e,t){return t.some(function(t){if(t.id===e.id)return!1;if(t.layer<=e.layer)return!1;var n=Math.abs(t.x-e.x)<2,s=Math.abs(t.y-e.y)<2;return n&&s})},G=function updateClickableStatus(e){return e.map(function(t){return(0,a.Z)((0,a.Z)({},t),{},{"isClickable":!S(t,e)})})},C=function checkMatch(e){var t={};e.forEach(function(e){t[e.type]=(t[e.type]||0)+1});var n=Object.keys(t).find(function(e){return t[e]>=3});if(n){var s=0;return{"newSlots":e.filter(function(e){return!(e.type===n&&s<3)||(s++,!1)}),"matched":!0}}return{"newSlots":e,"matched":!1}},b=function getDailyLayoutSeed(){var e=new Date;return function hashString(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return Math.abs(t)}("".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0")))},k=function generateDailyLayout(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:75,n=function createSeededRandom(e){var t=e;return function(){return(t=1103515245*t+12345&2147483647)/2147483647}}(e),s=[],a=0;a<t;a++)s.push({"x":Math.floor(9*n()),"y":Math.floor(12*n()),"layer":Math.floor(6*n())});return s.sort(function(e,t){return e.layer-t.layer}),s},Z=function assignRandomTileTypes(e){for(var t=Object.values(m.YU),n=Math.floor(e.length/3),s=[],a=0;a<n;a++){var l=t[Math.floor(Math.random()*t.length)];s.push(l,l,l)}for(var r=s.length-1;r>0;r--){var o=Math.floor(Math.random()*(r+1)),c=[s[o],s[r]];s[r]=c[0],s[o]=c[1]}var i=e.map(function(e,t){return{"id":"tile-".concat(t),"type":s[t]||m.YU.STAR,"x":e.x,"y":e.y,"layer":e.layer,"isClickable":!0}});return G(i)},w=function generateHeroLevel(e){var t=function generateHeroLayout(e){for(var t=function createSeededRandom(e){var t=e;return function(){return(t=1103515245*t+12345&2147483647)/2147483647}}(e+1e3),n=[],s=0;s<150;s++)n.push({"x":Math.floor(9*t()),"y":Math.floor(12*t()),"layer":Math.floor(8*t())});return n.sort(function(e,t){return e.layer-t.layer}),n}(e);return function assignHeroTileTypes(e){for(var t=Object.values(m.YU),n=[].concat(t),s=Math.floor(e.length/3),a=[],l=0;l<s;l++){var r=n[Math.floor(Math.random()*n.length)];a.push(r,r,r)}for(var o=a.length-1;o>0;o--){var c=Math.floor(Math.random()*(o+1)),i=[a[c],a[o]];a[o]=i[0],a[c]=i[1]}var u=e.map(function(e,t){return{"id":"hero-tile-".concat(t),"type":a[t]||m.YU.STAR,"x":e.x,"y":e.y,"layer":e.layer,"isClickable":!0}});return G(u)}(t)},D=n(5589),R=function Game(){var e=c.ZP.useRouter(),t=(0,r.useState)([]),n=(0,l.Z)(t,2),i=n[0],d=n[1],j=(0,r.useState)([]),S=(0,l.Z)(j,2),R=S[0],O=S[1],M=(0,r.useState)([[],[],[]]),T=(0,l.Z)(M,2),U=T[0],H=T[1],E=(0,r.useState)("playing"),L=(0,l.Z)(E,2),q=L[0],I=L[1],F=(0,r.useState)(m.GF.NORMAL),A=(0,l.Z)(F,2),B=A[0],V=A[1],z=(0,r.useState)((0,v.ns)()),P=(0,l.Z)(z,2),_=P[0],Y=P[1],$=(0,r.useState)([m.q2.BRONZE]),J=(0,l.Z)($,2),W=J[0],K=J[1],Q=(0,r.useState)(!1),X=(0,l.Z)(Q,2),ee=X[0],te=X[1],ne=(0,r.useState)(!1),se=(0,l.Z)(ne,2),ae=se[0],le=se[1],re=(0,r.useState)(!1),oe=(0,l.Z)(re,2),ce=oe[0],ie=oe[1],ue=(0,r.useState)(!1),de=(0,l.Z)(ue,2),he=de[0],me=de[1],fe=(0,r.useState)(0),xe=(0,l.Z)(fe,2),pe=xe[0],ve=xe[1],ye=(0,r.useRef)([]),je=(0,r.useRef)(0);(0,r.useEffect)(function(){var t=b();je.current=t,ye.current=k(t,75);var n=e.params.mode,s="true"===e.params.autowin;if("hero"===n){var a,l=(null===(a=(0,D.yu)().pendingChest)||void 0===a||null===(a=a.levels)||void 0===a?void 0:a[0])||m.q2.BRONZE;K([l]);var r=w(t);d(r),O([]),H([[],[],[]]),I("playing"),V(m.GF.HERO),te(!0),le(!0)}else Ne();s&&setTimeout(function(){Ge()},500)},[]);var Ne=function startNewGame(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Z(ye.current);d(t),O([]),H([[],[],[]]),I("playing"),ie(!1),e?Y(function(e){return(0,a.Z)((0,a.Z)({},e),{},{"toolsUsed":0,"undoUsed":!1,"shuffleUsed":!1,"popUsed":!1})}):(Y((0,v.ns)()),V(m.GF.NORMAL))},ge=function handleRetry(){if(Y(function(e){return(0,a.Z)((0,a.Z)({},e),{},{"attempts":e.attempts+1})}),B===m.GF.HERO){var e=w(je.current);d(e),O([]),H([[],[],[]]),I("playing"),ie(!1),Y(function(e){return(0,a.Z)((0,a.Z)({},e),{},{"toolsUsed":0,"undoUsed":!1,"shuffleUsed":!1,"popUsed":!1})})}else Ne(!0)},Se=function handleClaim(){console.log("handleClaim - heroAttempted:",ee,"gameMode:",B),(0,D.Z9)(W,B===m.GF.HERO),(0,D.gv)(_.attempts,!0,W[0],ee,B===m.GF.HERO&&"won"===q),ie(!1),I("won"),B===m.GF.HERO?c.ZP.switchTab({"url":"/pages/starocean/index","fail":function fail(e){console.error("Navigation to starocean failed:",e),c.ZP.reLaunch({"url":"/pages/starocean/index"})}}):c.ZP.switchTab({"url":"/pages/starlight/index","fail":function fail(e){console.error("Navigation to starlight failed:",e),c.ZP.reLaunch({"url":"/pages/starlight/index"})}})},Ge=function handleTestWin(){if("playing"===q){var e;if(d([]),O([]),H([[],[],[]]),I("won"),B===m.GF.HERO){var t=(0,v.bV)(W[0]);K(t),e=t[0],ie(!0)}else{e=(0,v.HS)(_),K([e]),le(!0);var n=(0,D.cn)(),s=N(n);n>0&&s?(ve(n),me(!0)):ie(!0)}var a=(0,D.yu)();(0,D.EG)(B,e,a.consecutiveDays)}},Ce=ae&&!ee;return(0,u.jsxs)(o.G7,{"className":"game-page ".concat(B===m.GF.HERO?"hero-mode":""),"children":[(0,u.jsxs)(o.G7,{"className":"header ".concat(B===m.GF.HERO?"hero-header":""),"children":[(0,u.jsxs)(o.G7,{"className":"stats-row","children":[(0,u.jsx)(o.xv,{"className":"day-text ".concat(B===m.GF.HERO?"hero-title":""),"children":B===m.GF.HERO?"ğŸ”¥ HERO MODE":"Day 1"}),(0,u.jsxs)(o.xv,{"className":"attempt-text ".concat(B===m.GF.HERO?"hero-attempt":""),"children":["ç¬¬ ",_.attempts," æ¬¡æŒ‘æˆ˜"]})]}),(0,u.jsxs)(o.G7,{"className":"header-right","children":[(0,u.jsx)(o.zx,{"className":"test-win-btn","onClick":Ge,"children":"ğŸ¯ ä¸€é”®è¿‡å…³"}),(0,u.jsx)(o.G7,{"className":"tools-status","children":(0,u.jsxs)(o.xv,{"children":["é“å…·: ",_.toolsUsed,"/3"]})})]})]}),(0,u.jsx)(h,{"tiles":i,"onTileClick":function handleTileClick(e){if("playing"===q&&!(R.length>=m.j$)){var t=i.filter(function(t){return t.id!==e.id}),n=G(t),a=[].concat((0,s.Z)(R),[e]);d(n),O(a);var l=C(a),r=l.newSlots;l.matched?O(r):r.length>=m.j$?I("lost"):O(r);var o=U.reduce(function(e,t){return e+t.length},0);if(0===n.length&&0===r.length&&0===o){var c,u;if(I("won"),B===m.GF.HERO)u=(0,v.bV)(W[0]),K(u),c=u[0],ie(!0);else{c=(0,v.HS)(_),K(u=[c]),le(!0);var h=(0,D.cn)(),f=N(h);h>0&&f?(ve(h),me(!0)):ie(!0)}var x=(0,D.yu)();(0,D.EG)(B,c,x.consecutiveDays)}}}}),(0,u.jsx)(x,{"stacks":U,"onStackClick":function handleTempStackClick(e){if("playing"===q){var t=function returnTileFromTempStack(e,t,n,a){if(t.length>=a)return{"newSlot":t,"newTempStacks":n,"success":!1};if(e<0||e>=n.length)return{"newSlot":t,"newTempStacks":n,"success":!1};if(0===n[e].length)return{"newSlot":t,"newTempStacks":n,"success":!1};var l=n.map(function(e){return(0,s.Z)(e)}),r=l[e].pop();return{"newSlot":[].concat((0,s.Z)(t),[r]),"newTempStacks":l,"success":!0}}(e,R,U,m.j$),n=t.newSlot,a=t.newTempStacks;if(t.success){H(a);var l=C(n),r=l.newSlots;l.matched?O(r):r.length>=m.j$?I("lost"):O(r)}}}}),(0,u.jsx)(f,{"tiles":R}),(0,u.jsx)(p,{"onUndo":function handleUndo(){if("playing"===q&&!_.undoUsed){var e=function undoLastTile(e,t){if(0===t.length)return{"newBoard":e,"newSlot":t,"success":!1};var n=t[t.length-1],a=t.slice(0,-1),l=[].concat((0,s.Z)(e),[n]);return{"newBoard":G(l),"newSlot":a,"success":!0}}(i,R),t=e.newBoard,n=e.newSlot;e.success&&(d(t),O(n),Y(function(e){return(0,a.Z)((0,a.Z)({},e),{},{"toolsUsed":e.toolsUsed+1,"undoUsed":!0})}))}},"onShuffle":function handleShuffle(){if("playing"===q&&!_.shuffleUsed){var e=function shuffleBoard(e){for(var t=e.map(function(e){return{"x":e.x,"y":e.y,"layer":e.layer}}),n=(0,s.Z)(t),l=n.length-1;l>0;l--){var r=Math.floor(Math.random()*(l+1)),o=[n[r],n[l]];n[l]=o[0],n[r]=o[1]}var c=e.map(function(e,t){return(0,a.Z)((0,a.Z)({},e),{},{"x":n[t].x,"y":n[t].y,"layer":n[t].layer})});return G(c)}(i);d(e),Y(function(e){return(0,a.Z)((0,a.Z)({},e),{},{"toolsUsed":e.toolsUsed+1,"shuffleUsed":!0})})}},"onRemove":function handleRemove(){if("playing"===q&&0!==R.length&&!_.popUsed){var e=function popTilesToTemp(e,t){if(0===e.length)return{"remainSlot":e,"newTempStacks":t,"success":!1};var n=Math.min(e.length,3),a=e.slice(0,n),l=e.slice(n),r=3===t.length?t.map(function(e){return(0,s.Z)(e)}):[[],[],[]];return a.forEach(function(e,t){r[t].push(e)}),{"remainSlot":l,"newTempStacks":r,"success":!0}}(R,U),t=e.remainSlot,n=e.newTempStacks;e.success&&(O(t),H(n),Y(function(e){return(0,a.Z)((0,a.Z)({},e),{},{"toolsUsed":e.toolsUsed+1,"popUsed":!0})}))}},"undoDisabled":_.undoUsed,"shuffleDisabled":_.shuffleUsed,"removeDisabled":_.popUsed}),he&&(0,u.jsx)(g,{"storyDay":pe,"onComplete":function handleStoryComplete(){(0,D.OO)(pe),me(!1),ie(!0)}}),ce&&"won"===q&&(0,u.jsx)(y,{"chestLevels":W,"stats":_,"gameMode":B,"canChallengeHero":Ce,"onClaim":Se,"onHeroChallenge":function startHeroMode(){var e=w(je.current);d(e),O([]),H([[],[],[]]),I("playing"),ie(!1),V(m.GF.HERO),te(!0),Y(function(e){return(0,a.Z)((0,a.Z)({},e),{},{"toolsUsed":0,"undoUsed":!1,"shuffleUsed":!1,"popUsed":!1})})},"onClose":Se}),"lost"===q&&B===m.GF.NORMAL&&(0,u.jsx)(o.G7,{"className":"overlay","children":(0,u.jsxs)(o.G7,{"className":"lost-modal","children":[(0,u.jsx)(o.xv,{"className":"lost-title","children":"æŒ‘æˆ˜å¤±è´¥"}),(0,u.jsx)(o.xv,{"className":"lost-msg","children":"æ§½ä½å·²æ»¡ï¼Œæ— æ³•ç»§ç»­æ¶ˆé™¤"}),(0,u.jsxs)(o.xv,{"className":"lost-attempt","children":["æœ¬æ¬¡æŒ‘æˆ˜ï¼šç¬¬ ",_.attempts," æ¬¡"]}),(0,u.jsx)(o.zx,{"className":"retry-btn","onClick":ge,"children":"å†æ¥ä¸€æ¬¡"})]})}),"lost"===q&&B===m.GF.HERO&&(0,u.jsx)(o.G7,{"className":"overlay","children":(0,u.jsxs)(o.G7,{"className":"lost-modal hero-lost","children":[(0,u.jsx)(o.xv,{"className":"lost-title","children":"HeroæŒ‘æˆ˜å¤±è´¥"}),(0,u.jsx)(o.xv,{"className":"lost-msg","children":"å†è¯•ä¸€æ¬¡ï¼Œæˆ–é¢†å–å½“å‰å®ç®±"}),(0,u.jsxs)(o.xv,{"className":"chest-keep","children":["å½“å‰ ",W[0]===m.q2.DIAMOND?"ğŸ’":W[0]===m.q2.GOLD?"ğŸ¥‡":W[0]===m.q2.SILVER?"ğŸ¥ˆ":"ğŸ¥‰"," å®ç®±"]}),(0,u.jsxs)(o.xv,{"className":"lost-attempt","children":["æœ¬æ¬¡æŒ‘æˆ˜ï¼šç¬¬ ",_.attempts," æ¬¡"]}),(0,u.jsx)(o.zx,{"className":"retry-btn","onClick":ge,"children":"å†æ¥ä¸€æ¬¡"}),(0,u.jsx)(o.zx,{"className":"claim-btn-secondary","onClick":Se,"children":"é¢†å–å®ç®±"})]})})]})}},"6891":function(e,t,n){n.d(t,{"Ge":function(){return getChestRewardDetails},"HS":function(){return calculateChestLevel},"PR":function(){return getChestLevelInfo},"bV":function(){return upgradeChestForHero},"ns":function(){return createInitialStats}});var s=n(5961);function calculateChestLevel(e){var t=e.attempts,n=e.toolsUsed;return 1===t?0===n?s.q2.DIAMOND:1===n?s.q2.GOLD:s.q2.SILVER:2===t?n<=1?s.q2.GOLD:s.q2.SILVER:3===t?n<=2?s.q2.SILVER:s.q2.BRONZE:t>=4&&t<=5&&n<=1?s.q2.SILVER:s.q2.BRONZE}function getChestLevelInfo(e){switch(e){case s.q2.DIAMOND:return{"emoji":"ğŸ’","name":"é’»çŸ³å®ç®±","color":"#00D4FF"};case s.q2.GOLD:return{"emoji":"ğŸ¥‡","name":"é»„é‡‘å®ç®±","color":"#FFD700"};case s.q2.SILVER:return{"emoji":"ğŸ¥ˆ","name":"ç™½é“¶å®ç®±","color":"#C0C0C0"};case s.q2.BRONZE:return{"emoji":"ğŸ¥‰","name":"é’é“œå®ç®±","color":"#CD7F32"}}}function getChestRewardDetails(e){switch(e){case s.q2.DIAMOND:return[{"coins":"é‡‘å¸Ã—500","props":"é“å…·Ã—3","lottery":"æŠ½å¥–åˆ¸Ã—2","physical":"10%å®ä½“å‘¨è¾¹"}];case s.q2.GOLD:return[{"coins":"é‡‘å¸Ã—300","props":"é“å…·Ã—2","lottery":"æŠ½å¥–åˆ¸Ã—1","physical":"3%å®ä½“å‘¨è¾¹"}];case s.q2.SILVER:return[{"coins":"é‡‘å¸Ã—150","props":"é“å…·Ã—1","lottery":"5%æŠ½å¥–åˆ¸","physical":""}];case s.q2.BRONZE:return[{"coins":"é‡‘å¸Ã—50","props":"é“å…·ç¢ç‰‡","lottery":"","physical":""}]}}function upgradeChestForHero(e){switch(e){case s.q2.BRONZE:return[s.q2.GOLD];case s.q2.SILVER:return[s.q2.DIAMOND];case s.q2.GOLD:return[s.q2.DIAMOND,s.q2.GOLD];case s.q2.DIAMOND:return[s.q2.DIAMOND,s.q2.DIAMOND]}}function createInitialStats(){return{"attempts":1,"toolsUsed":0,"undoUsed":!1,"shuffleUsed":!1,"popUsed":!1}}}}]);